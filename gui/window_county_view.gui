######################################################
################### COUNTY VIEW ######################
######################################################

window = {
	name = "holding_view"
	widgetid = "holding_view_id"
	parentanchor = bottom|left
	allow_outside = yes
	movable = no
	layer = windows_layer
	size = { 800 781 }
	datacontext = "[HoldingView.GetHolding]"
	datacontext = "[HoldingView.GetProvince]"
	datacontext = "[HoldingView.GetHolder]"
	datacontext = "[Province.GetCounty]"
	window_assign_excavation_leader = {}

	background = {
		texture = "gfx/interface/component_tiles/tile_window_background_subwindow.dds"
		spriteType = Corneredtiled
		spriteborder = { 18 18 }
		margin = { -23 -17 }
		margin_left = 20
		margin_bottom = 20
		texture_density = 2

		modify_texture = {
			name = "overlay"
			texture = "gfx/interface/component_overlay/overlay_effect.dds"
			spriteType = Corneredstretched
			spriteborder = { 0 0 }
			blend_mode = overlay
		}
	}

	state = {
		name = _show
		on_start = "[GetVariableSystem.Set( 'county_view_open', 'true' )]"
		on_start = "[GetVariableSystem.Set( 'hide_bottom_left_HUD', 'true' )]"
		
		# DEMD
		on_start = "[GetVariableSystem.Toggle( 'demd_county_view' )]" # this opens the window
		on_start = "[GetVariableSystem.Set( 'demd_county_view', 'overview_tab' )]" # this set the default tab
		onclick = "[GetVariableSystem.Clear( 'window_assign_excavation_leader' )]" # closes excavation leader selection window

		using = Animation_FadeIn_Standard
		using = Sound_WindowShow_Standard
		using = Animation_FadeIn_BottomLeft
	}

	state = {
		name = _hide
		on_start = "[GetVariableSystem.Clear( 'county_view_open' )]"
		on_start = "[GetVariableSystem.Clear( 'hide_bottom_left_HUD' )]"

		using = Animation_FadeOut_Standard
		using = Sound_WindowHide_Standard
		using = Animation_FadeOut_BottomLeft
	}


	vbox = {
		name = "window_content"
		margin_right = 40
		margin_top = 35

		hbox = {
			name = "county_header"
			layoutpolicy_horizontal = expanding
			margin_right = 15
			margin_left = 5
			margin_top = 5
			margin_bottom = 5
			spacing = 2

			background = {
				using = Background_Area_Dark
				margin_left = 5
			}

			coa_title_small = {
				datacontext = "[HoldingView.GetCountyTitle]"
			}

			vbox = {
				hbox = {
					layoutpolicy_horizontal = expanding
					ignoreinvisible = yes

					text_single = {
						layoutpolicy_horizontal = expanding
						text = "[HoldingView.GetCountyTitle.GetNameNoTooltip]"
						margin_bottom = 4
						using = Font_Size_Big
						font = TitleFont
						max_width = 380
						fontsize_min = 16
					}

					button_edit_text = {
						visible = "[HoldingView.GetCountyTitle.CanPlayerCustomizeTitle]"
						onclick = "[OpenTitleCustomizationWindow(HoldingView.GetCountyTitle)]"
						tooltip = "CUSTOMIZE_TITLE"
					}

				
					# Population
					hbox = {
						parentanchor = hcenter|vcenter 
						layoutpolicy_horizontal = expanding
						spacing = 3

						text_single = {
							layoutpolicy_horizontal = expanding
							raw_text = "[demd_population|E]:"
						}


						text_single = {
							raw_text = "[Province.GetCounty.GetTitle.MakeScope.ScriptValue('county_population')|1]k"
							default_format = "#high"
							tooltip = DEMD_WHOLE_COUNTY_POP_STATS
						}
					}
				}

				vbox = {
					datacontext = "[HoldingView.GetCountyTitle.GetHolder]"
					layoutpolicy_horizontal = expanding

					text_single = {
						name = "your_county"
						visible = "[ObjectsEqual( Character.Self, GetPlayer )]"
						layoutpolicy_horizontal = expanding
						text = "HOLDING_VIEW_YOUR_COUNTY"
						margin_left = 2
						margin_bottom = 4
						using = Font_Size_Small
					}

					text_single = {
						name = "top_realm_county"
						visible = "[Character.IsOtherLiegeOrAbove( GetPlayer )]"
						layoutpolicy_horizontal = expanding
						text = "HOLDING_VIEW_TOP_REALM_COUNTY"
						margin_left = 5
						margin_bottom = 4
						using = Font_Size_Small
					}

					text_single = {
						name = "foreign_county"
						visible = "[Not(Or(ObjectsEqual( Character.Self, GetPlayer ),Character.IsOtherLiegeOrAbove( GetPlayer )))]"
						layoutpolicy_horizontal = expanding
						text = "HOLDING_VIEW_FOREIGN_COUNTY"
						margin_left = 5
						margin_bottom = 4
						using = Font_Size_Small
					}
				}
			}

			expand = {}

			### SIEGE AND RAID GOTO BUTTON ###
			button_group = {
				name = "open_siege_button"
				datacontext = "[HoldingView.GetProvince.GetSiege]"
				visible = "[HoldingView.GetProvince.HasActiveSiege]"
				onclick = "[DefaultOnSiegeClick(Siege.GetID)]"
				tooltip = "[Siege.GetSiegeDescription]"
				using = tooltip_se
				shortcut = county_go_to_siege
				using = siege_goto_template
			}

			button_group = {
				name = "open_raid_button"
				datacontext = "[HoldingView.GetProvince.GetRaid]"
				visible = "[HoldingView.GetProvince.HasActiveRaid]"
				onclick = "[DefaultOnRaidClick( Raid.Self )]"
				tooltip = "MAP_RAID_TOOLTIP"
				shortcut = county_go_to_siege
				using = tooltip_se
				using = raid_goto_template
				blockoverride "tooltip" {}
			}

			buttons_window_control = {

				blockoverride "button_go_to"
				{
					tooltip = "GOTO_PROVINCE_TT"
					using = tooltip_ne
					onclick = "[HoldingView.PanToCountyCapital]"
				}

				blockoverride "button_back"
				{
					visible = "[HasViewHistory]"
					onclick = "[OpenFromViewHistory]"
					tooltip = "[GetViewHistoryTooltip]"
				}

				blockoverride "button_close"
				{
					onclick = "[HoldingView.Close]"
				}
			}
		}

		####################################
		########### COUNTY INFO ############
		####################################

		hbox = {
			layoutpolicy_horizontal = expanding
			margin = { 10 2 }
			spacing = 6

			hbox = {
				datamodel = "[HoldingView.GetDeJureLieges]"

				item = {
					coa_title_tiny_crown = {
						visible = "[GreaterThan_int32( Title.GetTierFrame, '(int32)3' )]"
						using = tooltip_se
					}
				}
			}

			text_single = {
				text = "DE_JURE_HIERARCHY"
				default_format = "#low"
			}

			expand = {}

			hbox = {
				name = "county_modifiers_grid"
				datamodel = "[HoldingView.GetCountyModifiers]"

				item = {
					modifier_item_icon = {
						size = { 30 30 }

						blockoverride "icon_data" {
						using = tooltip_ne
						}
					}
				}
			}

			hbox = {
				layoutpolicy_vertical = expanding
				visible = [County.IsFullyOccupied]
				datacontext = [County.GetCountyOccupant]

				widget = {
					size = { 52 52 }

					icon = {
						size = { 70 70 }
						name = "war_icon"
						texture = "gfx/interface/icons/war_status/war_icon.dds"
						parentanchor = center
					}

					coa_realm_small = {
						position = { 1 0 }
						blockoverride "coa_button" {
							tooltip = "COUNTY_OCCUPIER_TOOLTIP"
							onclick = "[DefaultOnRealmFlagClick(Character.GetID)]"
							onrightclick = "[DefaultOnCharacterRightClick(Character.GetID)]"
							button_ignore = none
							tooltip_enabled = "[Not(IsInteractionMenuOpenForCharacter(Character.GetID))]"
						}
					}
				}
			}
		}

		hbox = {
			name = "county_info"
			datacontext = "[HoldingView.GetProvince.GetCountyCapitalProvince]"
			layoutpolicy_horizontal = expanding

			background = {
				using = Background_Area
				margin_bottom = -2
			}

			hbox = {
				name = "holder_info"
				datacontext = "[HoldingView.GetCountyTitle.GetHolder]"
				visible = "[Province.IsValid]"
				layoutpolicy_horizontal = expanding
				margin = { 5 5 }
				margin_right = 15

				background = {
					name = "Held_directly_by_me"
					visible = "[ObjectsEqual( Character.Self, GetPlayer )]"
					texture = "gfx/interface/component_masks/patterns/mask_pattern_06.dds"
					spriteType = Corneredtiled
					margin = { -7 -5 }
					using = Color_Green
					alpha = 0.2

					modify_texture = {
						texture = "gfx/interface/component_masks/mask_fade_horizontal.dds"
						blend_mode = alphamultiply
						mirror = horizontal
					}

					modify_texture = {
						texture = "gfx/interface/component_masks/mask_rough_edges.dds"
						spriteType = Corneredtiled
						spriteborder = { 20 20 }
						texture_density = 2
						blend_mode = alphamultiply
					}
				}

				background = {
					name = "Held_by_someone_below_me"
					visible = "[Character.IsOtherLiegeOrAbove( GetPlayer )]"
					texture = "gfx/interface/component_masks/patterns/mask_pattern_06.dds"
					spriteType = Corneredtiled
					margin = { -7 -5 }
					using = Color_Blue
					alpha = 0.2

					modify_texture = {
						texture = "gfx/interface/component_masks/mask_fade_horizontal.dds"
						blend_mode = alphamultiply
						mirror = horizontal
					}

					modify_texture = {
						texture = "gfx/interface/component_masks/mask_rough_edges.dds"
						spriteType = Corneredtiled
						spriteborder = { 20 20 }
						texture_density = 2
						blend_mode = alphamultiply
					}
				}

				background = {
					name = "Held_under_my_Top_Liege,_but_Not_Me"
					visible = "[And(And(Not( ObjectsEqual( Character.Self, GetPlayer )),Not(Character.IsOtherLiegeOrAbove( GetPlayer ))),ObjectsEqual( Character.GetTopLiege, GetPlayer.GetTopLiege ))]"
					texture = "gfx/interface/component_masks/patterns/mask_pattern_06.dds"
					spriteType = Corneredtiled
					margin = { -7 -5 }
					using = Color_Bright_Yellow
					alpha = 0.2

					modify_texture = {
						texture = "gfx/interface/component_masks/mask_fade_horizontal.dds"
						blend_mode = alphamultiply
						mirror = horizontal
					}

					modify_texture = {
						texture = "gfx/interface/component_masks/mask_rough_edges.dds"
						spriteType = Corneredtiled
						spriteborder = { 20 20 }
						texture_density = 2
						blend_mode = alphamultiply
					}
				}

				#####

				## Holder
				portrait_head = {}

				vbox = {
					layoutpolicy_horizontal = expanding
					layoutpolicy_vertical = expanding
					margin_top = 6

					vbox = {
						layoutpolicy_horizontal = expanding
						margin_left = 10
						margin_bottom = 10

						text_single = {
							layoutpolicy_horizontal = expanding
							text = "HOLDING_VIEW_COUNTY_HOLDER"
							default_format = "#low"
						}

						hbox = {
							layoutpolicy_horizontal = expanding

							text_multi = {
								datacontext = "[HoldingView.GetCountyTitle.GetHolder]"
								visible = "[And(Character.HasRelationTo( GetPlayer ), Not(Character.IsPlayer))]"
								layoutpolicy_horizontal = expanding
								max_width = 187
								text = "[Character.GetRelationToString( GetPlayer )]"
								tooltip = "EXTENDED_RELATIONS_TOOLTIP"
								autoresize = yes
							}
						}

						text_multi = {
							datacontext = "[HoldingView.GetCountyTitle.GetHolder]"
							layoutpolicy_horizontal = expanding
							max_width = 188
							text = "[Character.GetShortUINameNoTooltip|U]"
							default_format = "#high"
							autoresize = yes
						}
					}

					expand = {}
				}
			}

			vbox = {
				name = "county_stats"
				layoutpolicy_vertical = expanding
				margin = { 10 10 }
				margin_right = 15
				min_width = 260

				datacontext = "[HoldingView.GetProvince.GetCounty]"
				datacontext = "[HoldingView.AccessCountyBreakdowns]"

				hbox = {
					layoutpolicy_horizontal = expanding
					spacing = 5

					text_single = {
						layoutpolicy_horizontal = expanding
						raw_text = "[control|E]:"
					}

					text_single = {
						text = "[County.GetControlLevel]"
						default_format = "#high"
						margin = { 5 0 }

						tooltipwidget = {
							county_control_tooltip_container = {}
						}

						background = {
							visible = "[LessThan_CFixedPoint(County.GetControl, '(CFixedPoint)100')]"
							margin = { 5 0 }
							using = Status_Bad
						}
					}

					text_single = {
						datacontext = "[CountyDataBreakdowns.AccessControl( County.Self )]"
						visible = "[Or( LessThan_CFixedPoint(County.GetControl, '(CFixedPoint)100'), LessThan_CFixedPoint(ValueBreakdown.GetFixedPointValue, '(CFixedPoint)0') )]"

						margin_right = 5
						text = "COUNTY_CONTROL_CHANGE_MONTHLY"

						tooltip_visible = "[ValueBreakdown.HasTooltip]"
						tooltipwidget = {
							widget_value_breakdown_tooltip = {}
						}
					}
				}

				hbox = {
					layoutpolicy_horizontal = expanding
					datacontext = "[County.GetCount.GetGovernment]"
					datacontext = "[CountyDataBreakdowns.AccessDevelopmentChange( County.Self )]"

					text_single = {
						layoutpolicy_horizontal = expanding
						raw_text = "[development|E]:"
					}

					text_single = {
						visible = "[GovernmentType.IsAffectedByDevelopment]"
                        text = "[County.GetDevelopmentLevel]"

						default_format = "#high"

						margin = { 5 0 }

                        tooltipwidget = {
                            county_development_tooltip_container = {}
                        }
  					}

					text_single = {
						visible = "[Not( GovernmentType.IsAffectedByDevelopment )]"
						text = "[County.GetDevelopmentLevel]"

						default_format = "#high;weak"

						margin = { 5 0 }

						tooltipwidget = {
							county_development_tooltip_container = {}
						}
					}

					text_single = {
						visible = "[GovernmentType.IsAffectedByDevelopment]"

						text = "[ValueBreakdown.GetValueIndicatorHideNone( '(CFixedPoint)-5', '(CFixedPoint)1' )]"

						tooltip_visible = "[ValueBreakdown.HasTooltip]"

						margin_left = -5

						tooltipwidget = {
							widget_value_breakdown_tooltip = {
								blockoverride "header_text" {
									text = "COUNTY_DEVELOPMENT_PROGRESS_MONTHLY_TOOLTIP_HEADER"
								}
							}
						}
					}
				}

				hbox = {
					layoutpolicy_horizontal = expanding
					spacing = 3

					text_single = {
						layoutpolicy_horizontal = expanding
						raw_text = "[county_opinion|E]:"
					}

					button_normal = {
						name = "in_faction"
						visible = "[HoldingView.IsInFaction]"
						onclick = "[HoldingView.OnGotoFaction]"
						tooltip = "COUNTY_IN_FACTION_TOOLTIP"
						size = { 20 20 }
						texture = "gfx/interface/icons/symbols/icon_warning.dds"
					}

					text_single = {
						datacontext = "[CountyDataBreakdowns.AccessOpinion( County.Self )]"

						text = "[ValueBreakdown.GetValue]"
						default_format = "#high"

						tooltip_visible = "[ValueBreakdown.HasTooltip]"

						margin = { 5 0 }

						tooltipwidget = {
							widget_value_breakdown_tooltip = {}
						}
					}
				}

				### Plague Resistance
				hbox = {
					datacontext = "[Holding.GetProvince]"
					datacontext = "[HoldingView.AccessPlagueResistanceBreakdown]"
					layoutpolicy_horizontal = expanding
					margin = { 2 0 }
					spacing = 3

					text_single = {
						layoutpolicy_horizontal = expanding
						text = "HOLDING_VIEW_EPIDEMIC_RESISTANCE"
						default_format = "#high"
					}

					expand = {}

					text_single = {
						text = "HOLDING_VIEW_EPIDEMIC_RESISTANCE_VALUE"
						default_format = "#high"
					}

					tooltip_visible = "[ValueBreakdown.HasTooltip]"
					tooltipwidget = {
                        widget_value_breakdown_tooltip = {}
                    }
				}
				
				hbox = {
					datacontext = "[County.GetCulture]"
					layoutpolicy_horizontal = expanding
					spacing = 2

					using = tooltip_ne

								text_single = {
						layoutpolicy_horizontal = expanding
						raw_text = "[culture|E]:"
					}

					text_single = {
                        visible = "[NotEqualTo_uint32(Culture.GetID, GetPlayer.GetCulture.GetID)]"
                        text = "COUNTY_CULTURE_ACCEPTANCE_DIFF_CULTURE"
                        margin_right = 5

                        tooltip = "CULTURE_ACCEPTANCE_TOOLTIP"
					}

					button_group = {
						# shortcut = "innovations_window"
						onclick = "[OpenGameViewData( 'culture_window', Culture.GetID )]"

						text_single = {
							text = "CULTURE_COUNTY_WINDOW"
							default_format = "#high"
							margin = { 5 0 }

							background = {
								visible = "[And( NotEqualTo_uint32(Culture.GetID, GetPlayer.GetCulture.GetID), EqualTo_CFixedPoint( Culture.GetAcceptance( GetPlayer.GetCulture ), '(CFixedPoint)100') )]"
								margin = { 5 0 }
								using = Status_Good
							}

							background = {
								visible = "[And(And( NotEqualTo_uint32(Culture.GetID, GetPlayer.GetCulture.GetID), NotEqualTo_CFixedPoint( Culture.GetAcceptance( GetPlayer.GetCulture ), '(CFixedPoint)100') ), NotEqualTo_CFixedPoint( Culture.GetAcceptance( GetPlayer.GetCulture ), '(CFixedPoint)0') )]"
								margin = { 5 0 }
								using = Status_Mixed
							}

							background = {
								visible = "[EqualTo_CFixedPoint( Culture.GetAcceptance( GetPlayer.GetCulture ), '(CFixedPoint)0') ) ]"
								margin = { 5 0 }
								using = Status_Bad
							}
						}

                        tooltipwidget = {
                            culture_tooltip = {
                                blockoverride "extra_info"
                                {
                                    text_single = {
                                        fonttintcolor = "[TooltipInfo.GetTintColor]"
                                        using = DefaultTooltipText
                                        visible = "[Not( ObjectsEqual( Culture.Self, GetPlayer.GetCulture ) )]"
                                        text = "COUNTY_NOT_YOUR_CULTURE"
                                    }
                                }
							}
						}
					}
				}

				hbox = {
					datacontext = "[County.GetFaith]"
					layoutpolicy_horizontal = expanding
					spacing = 2
					using = tooltip_ne

					tooltipwidget = {

						faith_tooltip = {

							blockoverride "extra_info" {
								using = faith_tooltip_click_default_extra_info

								text_single = {
									margin = { 10 0 }
									layoutpolicy_horizontal = expanding
									fonttintcolor = "[TooltipInfo.GetTintColor]"
									using = DefaultTooltipText
									visible = "[Not( ObjectsEqual( Faith.Self, GetPlayer.GetFaith ) )]"
									text = "COUNTY_NOT_YOUR_FAITH"
								}
							}
						}
					}

					text_single = {
						layoutpolicy_horizontal = expanding
						raw_text = "[faith|E]:"
					}

					vbox = {
						expand = { minimumsize = { 0 2 } }
						icon = {
							size = { 22 22 }
							datacontext = "[Province.GetCounty.GetFaith]"
							texture = "[Faith.GetIcon]"
						}
					}

					button_group = {
						# shortcut = "faith_window"
						onclick = "[OpenGameViewData( 'faith', Faith.GetID )]"

						text_single = {
							visible = "[EqualTo_uint32(Faith.GetID, GetPlayer.GetFaith.GetID)]"
							margin_right = 5
							text = "[Faith.GetNameNoTooltip]"
							default_format = "#high"
						}

						text_single = {
								visible = "[NotEqualTo_uint32(Faith.GetID, GetPlayer.GetFaith.GetID)]"
                            text = "[Faith.GetNameNoTooltip]"
                            default_format = "#high"
                            margin = { 5 0 }

                            background = {
								margin = { 5 0 }
								using = Status_Bad
							}
						}
					}
				}
			}
		}

		divider = {
			layoutpolicy_horizontal = expanding
		}
		
		# Tabs menu
		hbox = {
			layoutpolicy_horizontal = expanding
			
			hbox = {	
				hbox = {
					margin_left = 5
					spacing = 5
					datamodel = "[HoldingView.GetCountyHoldings]"

					item = {
						button_tab_dark = {
							datacontext = "[GUICountyHolding.GetHolding]"
							size = { 50 50  }
							down = "[And(GUICountyHolding.IsSelected,GetVariableSystem.HasValue( 'demd_county_view', 'overview_tab' ))]"
							alwaystransparent = "[And(GUICountyHolding.IsSelected,GetVariableSystem.HasValue( 'demd_county_view', 'overview_tab' ))]"
							onclick = "[GUICountyHolding.OnClick]"
							onclick = "[PdxGuiTriggerAllAnimations('holding_view_refresh')]"
							onclick = "[GetVariableSystem.Set( 'demd_county_view', 'overview_tab' )]"
							using = tooltip_ne
							tooltipwidget = { holding_tooltip_click = {} }

							icon_building_tab = {
								parentanchor = center
								position = { 0 1 }
								size = { 35 30 }
								alwaystransparent = yes
								down = "[And(GUICountyHolding.IsSelected,GetVariableSystem.HasValue( 'demd_county_view', 'overview_tab' ))]"
								texture = "[GUICountyHolding.GetHolding.GetType.GetTabIcon]"

								blockoverride "button_frames"
								{
									gfxtype = togglepushbuttongfx
									effectname = "NoHighlight"
									upframe = 4
									uphoverframe = 5
									uppressedframe = 6
									downframe = 5
								}
							}

							icon = {
								name = "realm_capital_icon"
								visible = "[GUICountyHolding.GetHolding.GetProvince.GetTitle.IsCountyCapital]"
								parentanchor = bottom|right
								size = { 32 32 }
								position = { 4 0 }
								framesize = { 63 63 }
								texture = "gfx/interface/icons/icon_capital.dds"
								frame = 1
							}
						}
					}
				}
				hbox = {
					margin_left = 5
					spacing = 5					

					# DEMD Edicts Tab
					button_tab_dark = {
						datacontext = "[GUICountyHolding.GetHolding]"
						size = { 100 50 }
						down = "[GetVariableSystem.HasValue( 'demd_county_view', 'law_tab' )]"
						alwaystransparent = "[GUICountyHolding.IsSelected]"
						onclick = "[GetVariableSystem.Set( 'demd_county_view', 'law_tab' )]"
						
						text_single = {
							raw_text = "Edicts"
							default_format = "#high"
							using = Font_Size_Big
							parentanchor = hcenter|vcenter
							align = nobaseline
							position = { 0 0 }
						}				
					}
					
					# DEMD Excavation Tab
					button_tab_dark = {
						datacontext = "[GUICountyHolding.GetHolding]"
						visible = "[GetScriptedGui('show_excavation_tab').IsShown( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End)]"
						size = { 100 50 }
						down = "[GetVariableSystem.HasValue( 'demd_county_view', 'excavation_tab' )]"
						alwaystransparent = "[GUICountyHolding.IsSelected]"
						onclick = "[GetVariableSystem.Set( 'demd_county_view', 'excavation_tab' )]"
						
						text_single = {
							raw_text = "Ruins"
							default_format = "#high"
							using = Font_Size_Big
							parentanchor = hcenter|vcenter
							align = nobaseline
							position = { 0 0 }
						}				
					}



				}				
			}

			expand = {}
		}

		####################################
		########## HOLDING INFO ############
		####################################
		margin_widget = {
			name = "holding_info"
			layoutpolicy_horizontal = expanding
			layoutpolicy_vertical = expanding
			minimumsize = { 0 200 }
			margin = { 10 5 }
			margin_bottom = 10
			margin_right = 15
			scissor = yes

			state = {
				name = "holding_view_refresh"
				next = a
				alpha = 0.5
			}

			state = {
				name = "a"
				alpha = 1
				duration = 0.5
				using = Animation_Curve_Default
			}

			background = {
				using = Background_Area_Dark
				margin_left = 5
				margin_top = 3
			}

			background = {
				visible = "[HoldingView.HasHolding]"
				texture = "[HoldingView.GetHolding.GetIllustration]"
				alpha = 0.8

				modify_texture = {
					texture = "gfx/interface/window_county/mask_holding_illustration.dds"
					blend_mode = alphamultiply
					alpha = 0.95
				}
			}
			background = {
				visible = "[Not(HoldingView.HasHolding)]"
				texture = "[HoldingView.GetProvince.GetTerrain.GetIllustration]"
				alpha = 0.7

				modify_texture = {
					texture = "gfx/interface/window_county/mask_holding_illustration.dds"
					blend_mode = alphamultiply
					alpha = 0.95
				}
			}

			vbox = {
				name = "constructing_holding"
				visible = "[HoldingView.IsBeingConstructed]"
				parentanchor = center
				spacing = 5
				expand = {}

				progressbar_standard = {
					name = "constructing_holding_progress"
					alwaystransparent = yes
					size = { 300 30 }
					value = "[HoldingView.GetConstructionProgressForSlot('(int32)0')]"
					direction = horizontal
					tooltip = "[HoldingView.GetHoldingUnderConstructionTooltip]"

					text_single = {
						parentanchor = center
						text = "[HoldingView.GetConstructionTimeLeftForSlot('(int32)0')]"
						default_format = "#high"
						align = nobaseline
						using = Font_Size_Medium
					}
				}

				button_standard_big = {
					name = "cancel_holding_construction"
					size = { 300 30 }
					text = "CANCEL_HOLDING_CONSTRUCTION"
					visible = "[HoldingView.CanCancelConstruction]"
					onclick = "[HoldingView.CancelHoldingConstruction]"
					tooltip = "CANCEL_HOLDING_CONSTRUCTION_TOOLTIP"
				}

				expand = {}
			}

			### Backgrounds ###

			#################################################
			#### Same as county owner (no background)

			#################################################
			#### Not same as county owner

			background = {
				visible = "[And(NotEqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID, HoldingView.GetTitle.GetLesseeOrHolder.GetID ), HoldingView.GetTitle.HasHolder)]"
				texture = "gfx/interface/component_masks/mask_frame.dds"
				spriteType = Corneredstretched
				spriteborder = { 15 15 }
				using = Color_Blue
				margin = { -3 -3 }
				alpha = 0.3
			}

			#################################################
			#### Leased to Church

			background = {
				#visible = "[And(NotEqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID, HoldingView.GetTitle.GetLesseeOrHolder.GetID ), HoldingView.GetTitle.HasHolder)]"
				visible = no
				texture = "gfx/interface/component_masks/mask_frame.dds"
				spriteType = Corneredstretched
				spriteborder = { 15 15 }
				using = Color_Red
				margin = { -3 -3 }
			}

			#################################################
			#### Leased to Holy Order

			background = {
				#visible = "[And(NotEqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID, HoldingView.GetTitle.GetLesseeOrHolder.GetID ), HoldingView.GetTitle.HasHolder)]"
				visible = no
				texture = "gfx/interface/component_masks/mask_frame.dds"
				spriteType = Corneredstretched
				spriteborder = { 15 15 }
				using = Color_Green
				margin = { -3 -3 }
			}

			###
			flowcontainer = {
				parentanchor = bottom|hcenter
				direction = vertical
				spacing = 5
				ignoreinvisible = yes
				button_standard_big = {
					name = "construct_holding"
					visible = "[And(And(Not(HoldingView.HasHolding), Not(HoldingView.IsBeingConstructed)),GetVariableSystem.HasValue( 'demd_county_view', 'overview_tab' ))]"
					
					size = { 300 50 }
					text = "CREATE_NEW_HOLDING_BUTTON"
					onclick = "[HoldingView.OnConstructHoldingClick]"
					tooltip = "[HoldingView.GetHoldingConstructionTooltip]"
					enabled = "[And(HoldingView.CanNewHoldingBeConstructed, Not(HoldingView.IsSelectingHoldingType))]"
				}
				progressbar_standard = {
					name = "expanding_holding_progress"
					visible = "[And(And(And(Not(HoldingView.HasHolding), Not(HoldingView.IsBeingConstructed)),GetScriptedGui('demd_show_holding_expansion').IsShown( GuiScope.SetRoot( Province.MakeScope ).End)),GetVariableSystem.HasValue( 'demd_county_view', 'overview_tab' ))]"
					alwaystransparent = yes
					size = { 300 30 }
					value = "[FixedPointToFloat(Province.MakeScope.Var('holding_construction_progress').GetValue)]"
					max = "[FixedPointToFloat(Province.MakeScope.ScriptValue('holding_construction_progress_max'))]"
					direction = horizontal
					tooltipwidget = { 
						holding_expansion_breakdown_widget = { 
						
						} 
					}

					text_single = {
						parentanchor = center
						raw_text = "[Province.MakeScope.ScriptValue('holding_construction_years_left')|0] Year(s)"
						default_format = "#high"
						align = nobaseline
						using = Font_Size_Medium
					}
				}
			}
			
			# DEMD: holding expansion
			vbox = {
				name = "holding_expansion" 
				
				parentanchor = center
				position = { 0 -10 }
				spacing = 5
				expand = {}

				
				expand = {}
			}


			### TOP LEFT
			flowcontainer = {
				ignoreinvisible = yes
				spacing = 5
				margin = { 5 5 }
				visible = "[GetVariableSystem.HasValue( 'demd_county_view', 'overview_tab' )]"

				coa_title_medium = {
					datacontext = "[HoldingView.GetTitle]"
					visible = "[HoldingView.GetTitle.HasHolder]"
				}

				flowcontainer = {
					direction = vertical
					ignoreinvisible = yes
					margin_top = 5

					flowcontainer = {
						visible = "[HoldingView.GetTitle.HasHolder]"
						ignoreinvisible = yes

						text_single = {
							text = "[HoldingView.GetProvince.GetTitle.GetNameNoTierNoTooltip]"
							tooltip = "[HoldingView.GetProvince.GetTitle.GetNameNoTierNoTooltip]"
							default_format = "#high"
							align = nobaseline
							using = Font_Size_Big
							max_width = 150
							fontsize_min = 14
						}

						button_edit_text = {
							visible = "[HoldingView.GetProvince.GetTitle.CanPlayerCustomizeTitle]"
							parentanchor = vcenter
							size = { 25 25 }
							onclick = "[OpenTitleCustomizationWindow(HoldingView.GetProvince.GetTitle)]"
							tooltip = "CUSTOMIZE_TITLE"
						}

						spacer = {
							size = { 3 3 }
						}

						widget = {
							size = { 32 32 }
							visible = "[And(HoldingView.GetProvince.GetTitle.IsCountyCapital, Not(HoldingView.GetProvince.IsRealmCapital))]"

							icon = {
								name = "county_capital_icon"
								parentanchor = center
								size = { 40 40 }
								texture = "gfx/interface/icons/icon_capital.dds"
								framesize = { 63 63 }
								frame = 1
								tooltip = "COUNTY_CAPITAL_TOOLTIP"
							}
						}

						widget = {
							size = { 32 32 }
							visible = "[HoldingView.GetProvince.IsRealmCapital]"

							icon = {
								name = "realm_capital_icon"
								parentanchor = center
								size = { 40 40 }
								framesize = { 63 63 }
								texture = "gfx/interface/icons/icon_capital.dds"
								frame = 2
								tooltip = "REALM_CAPITAL_TOOLTIP"
							}
						}

						widget = {
							size = { 32 32 }

							button_move_capital = {
								name = "set_realm_capital_button"
								visible = "[HoldingView.PotentialSetRealmCapital]"
								position = { -3 5 }
								texture = "gfx/interface/icons/flat_icons/move_capital.dds"
								onclick = "[HoldingView.SetRealmCapital]"
								tooltip = "[HoldingView.GetSetRealmCapitalTooltip]"
								enabled = "[HoldingView.CanSetRealmCapital]"
							}
							
							# Better if users can't mess with changing the county capital
							#button_move_capital = {
							#	name = "set_county_capital_button"
							#	visible = "[HoldingView.CanSetCountyCapital]"
							#	position = { -3 5 }
							#	texture = "gfx/interface/icons/flat_icons/move_capital.dds"
							#	onclick = "[HoldingView.SetCountyCapital]"
							#	tooltip = "SET_COUNTY_CAPITAL_TOOLTIP"
							#}
						}
					}

					text_single = {
						visible = "[Not(HoldingView.GetTitle.HasHolder)]"
						text = "[HoldingView.GetProvince.GetTitle.GetNameNoTierNoTooltip]"
						default_format = "#medium"
						using = Font_Size_Big
					}

					flowcontainer = {
						datacontext = "[HoldingView.GetGUIHoldingBuilding]"
						ignoreinvisible = yes

						text_label_left = {
							text = "[HoldingView.GetHoldingDesc]"
						}
					}

					text_single = {
						visible = "[HoldingView.GetProvince.IsOccupied]"
						text = "[HoldingView.GetOccupiedInfo]"
						default_format = "#high"
					}
				}
			}

			### BOTTOM LEFT
			widget = {
				parentanchor = vcenter|left
				position = { 0 -30 }
				size = { 280 150 }
				alwaystransparent = yes
				visible = "[GetVariableSystem.HasValue( 'demd_county_view', 'overview_tab' )]"
				background = {
					visible = "[And(NotEqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID, HoldingView.GetTitle.GetLesseeOrHolder.GetID ), HoldingView.GetTitle.HasHolder)]"
					texture = "gfx/interface/component_masks/patterns/mask_pattern_02.dds"
					spriteType = Corneredtiled
					using = Color_Blue
					alpha = 0.6
					margin_bottom = 10
					margin_left = 5

					modify_texture = {
						texture = "gfx/interface/component_masks/mask_fade_horizontal.dds"
						blend_mode = alphamultiply
						alpha = 0.9
						mirror = horizontal
					}

					modify_texture = {
						texture = "gfx/interface/component_masks/mask_texture_01.dds"
						spriteType = Corneredtiled
						spriteborder = { 15 15 }
						blend_mode = alphamultiply
					}

					modify_texture = {
						texture = "gfx/interface/component_masks/mask_fade_vertical.dds"
						blend_mode = alphamultiply
						mirror = vertical
					}
				}

				background = {
					visible = "[And(NotEqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID, HoldingView.GetTitle.GetLesseeOrHolder.GetID ), HoldingView.GetTitle.HasHolder)]"
					texture = "gfx/interface/component_masks/mask_frame.dds"
					spriteType = Corneredstretched
					spriteborder = { 15 15 }
					using = Color_Blue
					alpha = 0.6
					margin_bottom = 10
					margin_left = 5

					modify_texture = {
						texture = "gfx/interface/component_masks/mask_fade_horizontal.dds"
						blend_mode = alphamultiply
						alpha = 0.9
						mirror = horizontal
					}

					modify_texture = {
						texture = "gfx/interface/component_masks/mask_fade_vertical.dds"
						blend_mode = alphamultiply
						mirror = vertical
					}
				}

				vbox = {
					expand = {
						visible = "[Not(And(HoldingView.HasDuchyCapitalBuildingSlot, HoldingView.HasSpecialBuildingSlot ))]"
					}

					hbox = {
						layoutpolicy_horizontal = expanding
						margin = { 5 0 }

						button_standard = {
							name = "toggle_find_vassal"
							visible = "[And( ObjectsEqual( HoldingView.GetTitle.GetHolder, GetPlayer ), Not(HoldingView.GetTitle.IsLeasedOut) )]"
							enabled = "[HoldingView.CanGrantTitle]"
							text = "FIND_VASSAL_HEADER"
							onclick = "[HoldingView.ToggleFindVassalListWindow]"
							tooltip = "FIND_VASSAL_BUTTON_HOLDING_VIEW_TOOLTIP"
							max_width = 150
						}
						expand = {}
					}

					hbox = {
						datacontext = "[HoldingView.GetTitle.GetLesseeOrHolder]"
						visible = "[And(NotEqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID, HoldingView.GetTitle.GetLesseeOrHolder.GetID ), HoldingView.GetTitle.HasHolder)]"
						layoutpolicy_horizontal = expanding

						portrait_head_small = {
							blockoverride "opinion_box" {}
						}

						vbox = {
							name = "theocracy_property"
							datacontext = "[HoldingView.GetTitle.GetLesseeOrHolder]"
							layoutpolicy_vertical = expanding
							margin_top = 4
							margin_bottom = 7
							margin_left = 2

							expand = {}

							hbox = {
								layoutpolicy_horizontal = expanding
								
								hbox = {
									datacontext = "[HoldingView.GetTitle]"
									visible = "[Title.IsUnderTheocraticLease]"
									tooltip = "CHURCH_PROPERTY_TOOLTIP"
									layoutpolicy_horizontal = expanding

									icon = {
										name = "church_property"
										texture = "gfx/interface/icons/icon_holding_church.dds"
										size = { 30 30 }
									}

									expand = {}
								}
								
								container = {
									name = "revoke_lease_button"
									datacontext = "[HoldingView.GetTitle]"
									visible = "[Title.IsLeasedOut]"

									button_round  = {
										datacontext = "[Title.GetLessee]"
										visible = "[And( Or(Title.GetHolder.IsLocalPlayer, Title.GetHolder.IsOtherLiegeOrAbove( GetPlayer )), Character.IsPlayerInteractionShownAndCanPickTitle('revoke_leased_title_interaction', Title.Self) )]"
										enabled = "[Character.IsPlayerInteractionWithTargetTitleValid('revoke_leased_title_interaction', Title.Self)]"
										tooltip = "[Character.GetPlayerInteractionWithTargetTitleTooltip('revoke_leased_title_interaction', Title.Self)]"
										oversound = "event:/SFX/UI/Generic/sfx_ui_generic_pointer_over"
										clicksound = "event:/SFX/UI/Generic/sfx_ui_generic_select"

										button_revoke_lease = {
											parentanchor = center
											onclick = "[Character.OpenPlayerInteractionWithTargetTitle('revoke_leased_title_interaction', Title.Self)]"
										}
									}
								}
							}

							text_single = {
								datacontext = "[HoldingView.GetTitle]"
								visible = "[Not(Title.IsLeasedOut)]"
								layoutpolicy_horizontal = expanding
								text = "HOLDING_VIEW_HOLDER"
								default_format = "#low"
							}

							text_single = {
								datacontext = "[HoldingView.GetTitle]"
								visible = "[Title.IsLeasedOut]"
								layoutpolicy_horizontal = expanding
								text = "HOLDING_VIEW_LESSEE"
								default_format = "#low"
							}

							text_multi = {
								visible = "[Character.HasRelationTo( GetPlayer )]"
								layoutpolicy_horizontal = expanding
								text = "[Character.GetRelationToString( GetPlayer )]"
								tooltip = "EXTENDED_RELATIONS_TOOLTIP"
								default_format = "#low"
								autoresize = yes
								maximumsize = { 130 72 }
							}

							text_multi = {
								layoutpolicy_horizontal = expanding
								text = "[Character.GetShortUIName]"
								format_override = { high medium }
								autoresize = yes
								maximumsize = { 130 72 }
							}
						}

						expand = {}
					}
					expand = {
						visible = "[And(HoldingView.HasDuchyCapitalBuildingSlot, HoldingView.HasSpecialBuildingSlot )]"
					}
				}
			}

			### FEUDALIZE A TRIBAL HOLDING ###
			widget = {
				allow_outside = yes
				parentanchor = hcenter
				position = { 50 0 }
				
				button_round = {
					datacontext = "[HoldingView.GetGUIHoldingBuilding]"
					datacontext = "[HoldingView.GetTitle]"
					datacontext = "[HoldingView.GetHolder]"
					visible = "[And(GetVariableSystem.HasValue( 'demd_county_view', 'overview_tab' ),Character.IsPlayerInteractionWithTargetTitleValid('convert_holding_interaction', Title.Self))]"
					enabled = "[Character.IsPlayerInteractionWithTargetTitleValid('convert_holding_interaction', Title.Self)]"
					tooltip = "[Character.GetPlayerInteractionWithTargetTitleTooltip('convert_holding_interaction', Title.Self)]"
					oversound = "event:/SFX/UI/Generic/sfx_ui_generic_pointer_over"
					clicksound = "event:/SFX/UI/Generic/sfx_ui_generic_select"
					onclick = "[Character.OpenPlayerInteractionWithTargetTitle('convert_holding_interaction', Title.Self)]"
					
					button_feudalize_tribe = {
						size = { 25 25 }
						parentanchor = center
						alwaystransparent = yes
					}
				}

				button_round  = {
					datacontext = "[HoldingView.GetGUIHoldingBuilding]"
					datacontext = "[HoldingView.GetTitle]"
					datacontext = "[HoldingView.GetHolder]"
					visible = "[And(GetVariableSystem.HasValue( 'demd_county_view', 'overview_tab' ),And( Character.IsLocalPlayer, Character.IsPlayerInteractionShownAndCanPickTitle('feudalize_tribal_holding_interaction', Title.Self) ))]"
					enabled = "[Character.IsPlayerInteractionWithTargetTitleValid('feudalize_tribal_holding_interaction', Title.Self)]"
					tooltip = "[Character.GetPlayerInteractionWithTargetTitleTooltip('feudalize_tribal_holding_interaction', Title.Self)]"
					oversound = "event:/SFX/UI/Generic/sfx_ui_generic_pointer_over"
					clicksound = "event:/SFX/UI/Generic/sfx_ui_generic_select"
					onclick = "[Character.OpenPlayerInteractionWithTargetTitle('feudalize_tribal_holding_interaction', Title.Self)]"

					button_feudalize_tribe = {
						size = { 25 25 }
						parentanchor = center
						alwaystransparent = yes
					}
				}				
			}
			
			### BOTTOM RIGHT
			flowcontainer = {
				parentanchor = bottom|left
				spacing = 5
				direction = vertical
				visible = "[And(GetVariableSystem.HasValue( 'demd_county_view', 'overview_tab' ),HoldingView.GetTitle.HasHolder)]"
				button_standard = {
					datacontext = "[HoldingView.GetGUIHoldingBuilding]"
					parentanchor = left
					size = { 145 75 }
					allow_outside = yes
					onclick = "[GUIBuildingItem.OnClick]"
					down = "[GUIBuildingItem.IsHighlighted]"
					enabled = "[GUIBuildingItem.IsBuildingButtonEnabled]"
					tooltip = "[GUIBuildingItem.GetTooltip]"

					vbox = {
						margin = { 4 1 }

						### Fort Info
						hbox = {
							visible = "[HoldingView.GetProvince.HasFort]"
							layoutpolicy_horizontal = expanding
							spacing = 10
							margin_left = 2
							margin_right = 2
							margin_top = 2

							vbox = {
								layoutpolicy_horizontal = expanding
								tooltip = "[HoldingView.GetGarrisonTooltip]"
								spacing = -4

								hbox = {
									spacing = 2

									icon = {
										name = "icon_garrison"
										texture = "gfx/interface/icons/icon_garrison.dds"
										size = { 30 30 }
									}

									text_single = {
										text = "[HoldingView.GetCurrentGarrisonSize]"
										default_format = "#high"
										align = nobaseline
									}
								}

								hbox = {
									layoutpolicy_horizontal = expanding

									progressbar_standard_transparent = {
										layoutpolicy_horizontal = expanding
										
										size = { 0 10 }
										value = "[HoldingView.GetGarrisonRatio]"
										direction = horizontal
									}
								}
							}

							hbox = {
								spacing = 3
								tooltip = "[Province.GetFortLevelTooltip]"

								icon = {
									name = "icon_fort"
									texture = "gfx/interface/window_siege/fort_icon.dds"
									size = { 30 25 }
								}

								text_single = {
									text = "[HoldingView.GetProvince.GetFortLevel]"
									default_format = "#high"
									align = nobaseline
								}
							}
						}

						hbox = {
							spacing = 2
							margin_bottom = 2

							text_single = {
								text = "[HoldingView.GetHolding.GetPrimaryBuildingType.GetTypeName]"
								align = nobaseline
							}

							text_single = {
								visible = "[GUIBuildingItem.HasLevel]"
								text = "[GUIBuildingItem.GetCurrentOrConstrucingBuilding.GetLevel]"
								size = { 15 20 }
								margin = { 5 0 }
								margin_bottom = 3
								fontsize = 15
								default_format = "#low;bold"
								align = center;nobaseline

								background = {
									using = Background_Area_Dark
								}

								background = {
									using = Background_Area_Dark
								}

								background = {
									using = Background_Area_Dark
								}
							}

							warning_icon = {
								name = "wrong_type"
								datacontext = "[HoldingView.GetHolder]"
								visible = "[And(Not(HoldingView.GetHolding.IsEmpty),Not(HoldingView.GetHolding.IsValidForLesseeOrHolder))]"
								size = { 20 20 }
								tooltip = HOLDING_VIEW_WRONG_HOLDING_TYPE
							}

							warning_icon = {
								name = "reduced_by_fixable_situation"
								visible = "[GUIBuildingItem.IsBuildingDisabled]"
								size = { 20 20 }
							}
						}

						progressbar_standard = {
							name = "holding_upgrade_progressbar"
							layoutpolicy_horizontal = expanding
							visible = "[GUIBuildingItem.IsConstructing]"
							size = { 0 10 }
							alwaystransparent = yes
							value = "[GUIBuildingItem.GetConstructingProgress]"
							tooltip = "[GUIBuildingItem.GetTooltip]"
						}
					}
				}

				flowcontainer = {
					name = "buildings_grid_special"
					parentanchor = left
					ignoreinvisible = yes
					margin_right = -3

					# Upgrade buildings
					flowcontainer = {
						name = "buildings_grid"
						datamodel = "[HoldingView.GetBuildings]"
						ignoreinvisible = yes
						spacing = 3
						margin_right = 3
						righttoleft = yes

						item = {
							widget_building_item = {}
						}
					}

					flowcontainer = {
						visible = "[Or(HoldingView.HasDuchyCapitalBuildingSlot, HoldingView.HasSpecialBuildingSlot )]"
						spacing = 3
						ignoreinvisible = yes

						widget_building_item = {
							name = "duchy_capital_building"
							datacontext = "[HoldingView.GetGUIDuchyCapitalBuilding]"
							visible = "[HoldingView.HasDuchyCapitalBuildingSlot]"

							button_standard = {
								size = { 100% 100% }
								texture = "gfx/interface/buttons/button_duchy_capital.dds"
								alwaystransparent = yes
								spriteborder = { 20 20 }
							}
						}

						widget_building_item = {
							name = "special_building"
							datacontext = "[HoldingView.GetGUISpecialBuilding]"
							visible = "[HoldingView.HasSpecialBuildingSlot]"

							button_standard = {
								size = { 100% 100% }
								texture = "gfx/interface/buttons/button_special_building.dds"
								alwaystransparent = yes
								spriteborder = { 20 20 }
							}
						}

						widget = {
							# This is needed to offset the building slots correctly when special building slots exist.
							name = "Conditional_margin_widget"
							size = { 0 0 }
							visible = "[HoldingView.HasSpecialBuildingSlot]"
						}
					}
				}
			}				
				
				vbox = {
					layoutpolicy_vertical = expanding
					margin = { 7 3 }

					fixedgridbox = {
						name = "holding_statuses"
						datamodel = "[HoldingView.GetHoldingStatuses]"
						flipdirection = yes
						datamodel_wrap = 2
						maxverticalslots = 4

						addrow = 35
						addcolumn = 37

						item = {
							container = {
								icon = {
									name = "terrain"
									visible = "[HoldingStatus.IsTerrainType]"
									datacontext = "[HoldingStatus.GetTerrainType]"
									texture = "[Terrain.GetIcon]"
									size = { 35 35 }
									tooltip = "HOLDING_TERRAIN_TOOLTIP"
								}

								button_round = {
									name = "stationed_maa_button"
									size = { 35 35 }

									datacontext = "[HoldingStatus.GetMAAOriginHere]"

									visible = "[HoldingStatus.IsMAAOriginHere]"

									tooltip = "VIEW_MAA_ORIGIN_TT"
									
									onclick = "[OpenGameView( 'military' )]"
									onclick = "[OpenGameViewData( 'men_at_arms', Regiment.GetID )]"

									button_icon_highlight = {
										texture = "gfx/interface/icons/flat_icons/army_details.dds"
										parentanchor = center
										alwaystransparent = yes
										size = { 35 35 }
									}
								}
								
								icon = {
									visible = "[HoldingStatus.IsMAATypeOriginHere]"
									datacontext = "[HoldingStatus.GetMAATypeOriginHere]"
									texture = "[MenAtArmsType.GetIcon]"
									alwaystransparent = yes
									size = { 35 35 }
									tooltip = "SHOW_MAA_ORIGIN_TT"
								}

								container = {
									visible = "[HoldingStatus.IsWinterLevel]"

									icon = { # Mild Winter
										name = "winter_level_icon_mild"
										visible = "[EqualTo_int32( HoldingStatus.GetWinterLevel, '(int32)1' )]"
										texture = "gfx/interface/icons/terrain_types/winter_mild.dds"
										size = { 35 35 }
										tooltip = "PROVINCE_VIEW_TOOLTIP_WINTER"
									}

									icon = { # Normal Winter
										name = "winter_level_icon_normal"
										visible = "[EqualTo_int32( HoldingStatus.GetWinterLevel, '(int32)2' )]"
										texture = "gfx/interface/icons/terrain_types/winter_normal.dds"
										size = { 35 35 }
										tooltip = "PROVINCE_VIEW_TOOLTIP_WINTER"
									}

									icon = { # Harsh Winter
										name = "winter_level_icon_harsh"
										visible = "[EqualTo_int32( HoldingStatus.GetWinterLevel, '(int32)3' )]"
										texture = "gfx/interface/icons/terrain_types/winter_harsh.dds"
										size = { 35 35 }
										tooltip = "PROVINCE_VIEW_TOOLTIP_WINTER"
									}
								}

								container = {
									visible = "[HoldingStatus.IsEpidemic]"
									datacontext = "[HoldingStatus.GetEpidemic]"
									
									button_epidemic = {
										blockoverride "extra_data"
										{
											datacontext = "[Epidemic.GetInfectionLevelIn( HoldingView.GetProvince )]"

											spacer = { size = { 0 16 } }
											
											cooltip_paragraph = {
												visible = "[EpidemicInfectionLevel.HasRealmModifier]"
												text = "[EpidemicInfectionLevel.GetRealmModifierDesc]"
											}
											cooltip_paragraph = {
												visible = "[Or( EpidemicInfectionLevel.HasProvinceModifier, EpidemicInfectionLevel.HasCountyModifier )]"
												text = "EPIDEMIC_MODIFIERS_PROVINCE_AND_COUNTY"
											}
										}

										blockoverride "infection_chance_text"
										{
											text = "EPIDEMIC_TOOLTIP_CHANCE_OF_INFECTION_SPECIFIC_PROVINCE"
										}
									}
								}


								container = {
									visible = "[HoldingStatus.IsLegend]"
									datacontext = "[HoldingStatus.GetLegend]"

									button_legend = {
										visible = "[Not( Or( Legend.IsCurrentlyPromotedInProvince( Province.Self ), Legend.WasPromotedOnCompletionInProvince( Province.Self ) ) )]"
										effectname = "GreyedOut"

										blockoverride "province_details" {
											text_multi = {
												layoutpolicy_horizontal = expanding
												autoresize = yes
												maximumsize = { 400 300 }

												text = "DISABLED_LEGEND_PROVINCE_MODIFIERS"
											}
										}
									}

									button_legend = {
										visible = "[Or( Legend.IsCurrentlyPromotedInProvince( Province.Self ), Legend.WasPromotedOnCompletionInProvince( Province.Self ) )]"
									}
								}

								container = {
									visible = "[HoldingStatus.IsTimedModifier]"
									datacontext = "[HoldingStatus.GetTimedModifier]"

									modifier_item_icon = {
										size = { 30 30 }

										blockoverride "icon_data"
										{
											using = tooltip_ne
										}
									}
								}
							}
						}
					}

					expand = {}
				}
	
				# DEMD Overview (Provinces) Tab (the default tab)
				hbox = {
					parentanchor = right
					ignoreinvisible = yes
					#direction = vertical
					margin_left = 600
					spacing = 4
					min_width = 70
					#margin_top = 20
					#margin_right = -10
					visible = "[GetVariableSystem.HasValue( 'demd_county_view', 'overview_tab' )]"
					enabled = "[GetVariableSystem.HasValue( 'demd_county_view', 'overview_tab' )]"
					#texture = "gfx/interface/component_masks/mask_frame.dds"
					
					
					
					flowcontainer = {
						direction = vertical
						spacing = 7
						visible = "[HoldingView.HasHolding]"
						
						flowcontainer = {
							min_width = 200
							margin_top = -20
							direction = vertical
							spacing = 5
							background = {
								using = Background_Area_Dark
								alpha = 1
								margin_bottom = 3
								margin_left = 8
								margin_right = 8
								margin_top = 22
								
							}
							text_single = {
								parentanchor = hcenter
								raw_text = "#bold Income #!"
								default_format = "#high"
								#fontsize = 20
							}
							
							spacer = { size = { 5 0 } }
							# demographic info
							flowcontainer = {
								spacing = 3
								parentanchor = hcenter
								flowcontainer = {							
									icon = {
										name = "icon_demd_gold"
										texture = "gfx/interface/icons/demd/resources/gold.dds"
										size = { 25 25 }
										tooltip = "[Province.GetCountyCapitalProvince.GetHolding.GetTaxTooltip]"
									}
                                    background = {
                                        visible = "[Holding.LevyAndTaxIsAffectedByFixableSituation]"
                                        using = Status_Bad
                                    }
									text_single = {
										raw_text = "[Province.GetHolding.GetIncome|2]"
										default_format = "#V"
										tooltipwidget = { 
                                            tax_breakdown_widget = { 
                                            
                                            } 
                                        }
									}
								}
								spacer = { size = { 5 0 } }
								flowcontainer = {
									tooltipwidget = { 
                                        manpower_breakdown_widget = { 
                                        
                                        } 
                                    }
                                    background = {
                                        visible = "[Holding.LevyAndTaxIsAffectedByFixableSituation]"
                                        using = Status_Bad
                                    }
									icon = {
										name = "icon_demd_supply"
										texture = "gfx/interface/icons/demd/jobs/guardsman.dds"
										size = { 25 25 }
									}
									text_single = {
										raw_text = "[Province.MakeScope.ScriptValue('total_manpower_gui')|k]"
										default_format = "#high"
									}
								}								
							}
						}
						spacer = { size = { 0 4 } }
						flowcontainer = {
							direction = vertical
							spacing = 4
							background = {
								using = Background_Area_Dark
								alpha = 1
								margin_bottom = 3
								margin_left = 8
								margin_right = 8
								margin_top = 3
								
							}
							text_single = {
								parentanchor = hcenter
								raw_text = "#bold Rural Population #!"
								default_format = "#high"
								#fontsize = 20
							}
							spacer = { size = { 0 3 } }
							flowcontainer = {
								parentanchor = hcenter
								flowcontainer = {
									tooltipwidget = { 
                                        population_province_breakdown_widget = { 
                                        
                                        } 
                                    }
									icon = {
										name = "icon_demd_population"
										texture = "gfx/interface/icons/demd/jobs/clerk.png"
										size = { 25 25 }
									}
									text_single = {
										raw_text = " [Province.MakeScope.Var('population').GetValue|1]k"
										default_format = "#high"
									}
								}
								spacer = { size = { 5 0 } }
								flowcontainer = {
									tooltipwidget = { 
                                        growth_province_breakdown_widget = { 
                                        
                                        } 
                                    }
									icon = {
										name = "icon_demd_growth"
										texture = "gfx/interface/icons/message_feed/council.dds"
										size = { 25 25 }
									}
									text_single = {
										raw_text = " [Province.MakeScope.ScriptValue('growth_rate_display')|%1]"
										default_format = "#high"
									}
								}
								spacer = { size = { 5 0 } }
								flowcontainer = {
									tooltipwidget = { 
                                        migration_province_breakdown_widget = { 
                                        
                                        } 
                                    }
									icon = {
										name = "icon_demd_migration"
										texture = "gfx/interface/icons/message_feed/guest.dds"
										size = { 25 25 }
									}
									text_single = {
										raw_text = " [Province.MakeScope.Var('internal_migration_growth_percent').GetValue|%1]"
										default_format = "#high"
									}	
								}
							}											
							divider_light = { size = { 100% 3 } parentanchor = hcenter }
							text_single = {
								parentanchor = hcenter
								raw_text = "#bold Industry #!"
								default_format = "#high"
							}
							flowcontainer = {
								parentanchor = hcenter
								flowcontainer = {
									tooltipwidget = { 
                                        food_breakdown_widget = { 
                                        
                                        } 
                                    }
									icon = {
										name = "icon_demd_food"
										texture = "gfx/interface/icons/demd/resources/food.png"
										size = { 25 25 }
									}
									text_single = {
										raw_text = " [Province.MakeScope.Var('food_ratio').GetValue|%0]"
										default_format = "#high"
									}
								}
								spacer = { size = { 5 0 } }	
								flowcontainer = {
									tooltipwidget = { 
                                        goods_province_breakdown_widget = { 
                                        
                                        } 
                                    }
									icon = {
										name = "icon_goods"
										texture = "gfx/interface/icons/demd/resources/goods.png"
										size = { 25 25 }
									}
									text_single = {
										raw_text = "+[Province.MakeScope.Var('capital_production_multiplier').GetValue|%0]"
										default_format = "#high"
									}
								}	
								spacer = { size = { 5 0 } }	
								flowcontainer = {
									tooltipwidget = { 
                                        knight_capacity_breakdown_widget = { 
                                        
                                        } 
                                    }
									icon = {
										name = "icon_goods"
										texture = "gfx/interface/icons/demd/resources/knight_capacity.dds"
										size = { 25 25 }
									}
									text_single = {
										raw_text = "[Province.MakeScope.Var('knight_capacity_produced').GetValue|2]"
										default_format = "#high"
									}
								}								
							}
						}
						spacer = { size = { 0 4 } }
						flowcontainer = {
							visible = "[Holding.GetProvince.GetTitle.IsCountyCapital]"
							#margin_top = -20
							direction = vertical
							spacing = 4
							background = {
								using = Background_Area_Dark
								alpha = 1
								margin_bottom = 15
								margin_left = 8
								margin_right = 8
								#margin_top = 30
								
							}
							text_single = {
								parentanchor = hcenter
								raw_text = "#bold Urban Population #!"
								default_format = "#high"
								#fontsize = 20
							}
							spacer = { size = { 0 3 } }
							flowcontainer = {
								parentanchor = hcenter
								flowcontainer = {
									tooltipwidget = { 
                                        population_county_breakdown_widget = { 
                                        
                                        } 
                                    }
									icon = {
										name = "icon_demd_population"
										texture = "gfx/interface/icons/demd/jobs/clerk.png"
										size = { 25 25 }
									}
									text_single = {
										raw_text = " [Province.GetCounty.GetTitle.MakeScope.Var('population').GetValue|1]k"
										default_format = "#high"
									}
								}
								spacer = { size = { 5 0 } }
								flowcontainer = {
									tooltipwidget = { 
                                        growth_county_breakdown_widget = { 
                                        
                                        } 
                                    }
									icon = {
										name = "icon_demd_growth"
										texture = "gfx/interface/icons/message_feed/council.dds"
										size = { 25 25 }
									}
									text_single = {
										raw_text = " [Province.GetCounty.GetTitle.MakeScope.ScriptValue('growth_rate_display')|%1]"
										default_format = "#high"
									}
								}
								spacer = { size = { 5 0 } }
								flowcontainer = {
									tooltipwidget = { 
                                        migration_county_breakdown_widget = { 
                                        
                                        } 
                                    }
									icon = {
										#tooltip = "[demd_migration_pull|E]"
										name = "icon_demd_migration"
										texture = "gfx/interface/icons/message_feed/guest.dds"
										size = { 25 25 }
									}
									text_single = {
										#tooltip = "[demd_migration_pull|E]"
										raw_text = " [Province.GetCounty.GetTitle.MakeScope.ScriptValue('total_migration_growth_percent')|%1]"
										default_format = "#high"
									}	
								}
							}
							divider_light = { size = { 100% 3 } }							
							text_single = {
								parentanchor = hcenter
								raw_text = "#bold Industry #!"
								default_format = "#high"
							}
							flowcontainer = {
								parentanchor = hcenter
								flowcontainer = {
									tooltipwidget = { 
                                        food_county_breakdown_widget = { 
                                        
                                        } 
                                    }
									icon = {
										name = "icon_demd_food"
										texture = "gfx/interface/icons/demd/resources/food.png"
										size = { 25 25 }
									}
									text_single = {
										raw_text = " [Province.GetCounty.GetTitle.MakeScope.Var('food_ratio').GetValue|%0]"
										default_format = "#high"
									}
								}
								spacer = { size = { 5 0 } }
								flowcontainer = {
									tooltipwidget = { 
                                        goods_breakdown_widget = { 
                                        
                                        } 
                                    }
									icon = {
										name = "icon_goods"
										texture = "gfx/interface/icons/demd/resources/goods.png"
										size = { 25 25 }
									}
									text_single = {
										raw_text = " +[Province.GetCounty.GetTitle.MakeScope.Var('capital_production_multiplier').GetValue|0%]"
										default_format = "#high"
									}
								}
								spacer = { size = { 5 0 } }
								flowcontainer = {
									tooltipwidget = { 
                                        trade_breakdown_widget = { 
                                        
                                        } 
                                    }
									icon = {
										name = "icon_demd_trade_value"
										texture = "gfx/interface/icons/demd/resources/trade_resources/trade_value.dds"
										size = { 25 25 }
									}
									text_single = {
										raw_text = " [Province.GetCounty.GetTitle.MakeScope.Var('trade_value').GetValue|1]"
										default_format = "#high"
									}
								}
							}
							divider_light = { size = { 100% 3 } parentanchor = hcenter }
							text_single = {
								parentanchor = hcenter
								raw_text = "#bold Status #!"
								default_format = "#high"
								#fontsize = 20
							}
							flowcontainer = {
								parentanchor = hcenter
								flowcontainer = {
									tooltipwidget = { 
                                        sanitation_target_breakdown_widget = { 
                                        
                                        } 
                                    }
									icon = {
										name = "icon_sanitation"
										texture = "gfx/interface/icons/demd/resources/sanitation.dds"
										size = { 25 25 }
									}
									text_single = {
										raw_text = " [Province.GetCounty.GetTitle.MakeScope.Var('sanitation').GetValue|%0]"
										default_format = "#high"
									}
								}
								spacer = { size = { 5 0 } }
								flowcontainer = {
									tooltipwidget = { 
                                        public_order_target_breakdown_widget = { 
                                        
                                        } 
                                    }
									icon = {
										name = "icon_public_order"
										texture = "gfx/interface/icons/demd/resources/public_order.dds"
										size = { 25 25 }
									}
									text_single = {
										raw_text = " [Province.GetCounty.GetTitle.MakeScope.Var('public_order').GetValue|%0]"
										default_format = "#high"
									}
								}								
							}
							
							
							
							
														
						}
					}
						
						

					expand = {}
				}
			
				# DEMD Law Tab (where the tax options live)
				flowcontainer = {
					name = "law"
					parentanchor = hcenter|vcenter
					
					spacing = 4
					min_width = 500
					#parentanchor = top|right
					#ignoreinvisible = yes
					visible = "[GetVariableSystem.HasValue( 'demd_county_view', 'law_tab' )]"
					enabled = "[GetVariableSystem.HasValue( 'demd_county_view', 'law_tab' )]"
					#texture = "gfx/interface/component_masks/mask_rough_edges.dds"
					margin_top = 70
					#using = Background_Letter
					

					# legal options
					flowcontainer = {
						direction = vertical
						parentanchor = hcenter						
					
						# tax options
						flowcontainer = {
							margin_top = 30
							margin_bottom = 45
							#margin_left = 10
							#margin_right = 10
							
							direction = vertical
							#parentanchor = left
																															

							flowcontainer = {	
								widget_county_amenity_right = { # Tax
									blockoverride "amenity_name" { text = "[Province.GetCounty.GetTitle.Custom('demd_tax_edict_get_modifier')]" }
									blockoverride "amenity_icon_texture" { texture = "gfx/interface/window_roco_grandeur/icon_amenity_lodgings.dds" } 
									blockoverride "amenity_level_int" { text = "[Province.GetCounty.GetTitle.MakeScope.Var('tax_setting').GetValue|0]" } 
									
									# LEVEL 0
									blockoverride "amenity_level_0_effects" { 
										onclick = "[GetScriptedGui('demd_set_tax_0').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_tax_0').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_0_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('tax_setting').GetValue, '(CFixedPoint)0')]"
									}
									blockoverride "amenity_level_0_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('tax_setting').GetValue, '(CFixedPoint)0')]"
									}
									blockoverride "amenity_level_0_tooltip" { tooltip = DEMD_TAX_0_TOOLTIP }
									
									# LEVEL 1
									blockoverride "amenity_level_1_effects" { 
										onclick = "[GetScriptedGui('demd_set_tax_1').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_tax_1').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_1_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('tax_setting').GetValue, '(CFixedPoint)1')]"
									}
									blockoverride "amenity_level_1_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('tax_setting').GetValue, '(CFixedPoint)1')]"
									}
									blockoverride "amenity_level_1_tooltip" { tooltip = DEMD_TAX_1_TOOLTIP }
									
									# LEVEL 2
									blockoverride "amenity_level_2_effects" { 
										onclick = "[GetScriptedGui('demd_set_tax_2').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_tax_2').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_2_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('tax_setting').GetValue, '(CFixedPoint)2')]"
									}
									blockoverride "amenity_level_2_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('tax_setting').GetValue, '(CFixedPoint)2')]"
									}
									blockoverride "amenity_level_2_tooltip" { tooltip = DEMD_TAX_2_TOOLTIP }
									
									# LEVEL 3
									blockoverride "amenity_level_3_effects" { 
										onclick = "[GetScriptedGui('demd_set_tax_3').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_tax_3').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_3_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('tax_setting').GetValue, '(CFixedPoint)3')]"
									}
									blockoverride "amenity_level_3_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('tax_setting').GetValue, '(CFixedPoint)3')]"
									}
									blockoverride "amenity_level_3_tooltip" { tooltip = DEMD_TAX_3_TOOLTIP }
									
									# LEVEL 4
									blockoverride "amenity_level_4_effects" { 
										onclick = "[GetScriptedGui('demd_set_tax_4').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_tax_4').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_4_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('tax_setting').GetValue, '(CFixedPoint)4')]"
									}
									blockoverride "amenity_level_4_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('tax_setting').GetValue, '(CFixedPoint)4')]"
									}
									blockoverride "amenity_level_4_tooltip" { tooltip = DEMD_TAX_4_TOOLTIP }											
									
								}
								widget_county_amenity_left = { # Manpower
									blockoverride "amenity_name" { text = "[Province.GetCounty.GetTitle.Custom('demd_manpower_edict_get_modifier')]" }
									blockoverride "amenity_icon_texture" { texture = "gfx/interface/window_roco_grandeur/icon_amenity_lodgings.dds" } 
									blockoverride "amenity_level_int" { text = "[Province.GetCounty.GetTitle.MakeScope.Var('manpower_setting').GetValue|0]" } 
									
									# LEVEL 0
									blockoverride "amenity_level_0_effects" { 
										onclick = "[GetScriptedGui('demd_set_manpower_0').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_manpower_0').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_0_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('manpower_setting').GetValue, '(CFixedPoint)0')]"
									}
									blockoverride "amenity_level_0_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('manpower_setting').GetValue, '(CFixedPoint)0')]"
									}
									blockoverride "amenity_level_0_tooltip" { tooltip = DEMD_MANPOWER_0_TOOLTIP }
									
									# LEVEL 1
									blockoverride "amenity_level_1_effects" { 
										onclick = "[GetScriptedGui('demd_set_manpower_1').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_manpower_1').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_1_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('manpower_setting').GetValue, '(CFixedPoint)1')]"
									}
									blockoverride "amenity_level_1_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('manpower_setting').GetValue, '(CFixedPoint)1')]"
									}
									blockoverride "amenity_level_1_tooltip" { tooltip = DEMD_MANPOWER_1_TOOLTIP }
									
									# LEVEL 2
									blockoverride "amenity_level_2_effects" { 
										onclick = "[GetScriptedGui('demd_set_manpower_2').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_manpower_2').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_2_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('manpower_setting').GetValue, '(CFixedPoint)2')]"
									}
									blockoverride "amenity_level_2_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('manpower_setting').GetValue, '(CFixedPoint)2')]"
									}
									blockoverride "amenity_level_2_tooltip" { tooltip = DEMD_MANPOWER_2_TOOLTIP }
									
									# LEVEL 3
									blockoverride "amenity_level_3_effects" { 
										onclick = "[GetScriptedGui('demd_set_manpower_3').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_manpower_3').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_3_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('manpower_setting').GetValue, '(CFixedPoint)3')]"
									}
									blockoverride "amenity_level_3_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('manpower_setting').GetValue, '(CFixedPoint)3')]"
									}
									blockoverride "amenity_level_3_tooltip" { tooltip = DEMD_MANPOWER_3_TOOLTIP }
									
									# LEVEL 4
									blockoverride "amenity_level_4_effects" { 
										onclick = "[GetScriptedGui('demd_set_manpower_4').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_manpower_4').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_4_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('manpower_setting').GetValue, '(CFixedPoint)4')]"
									}
									blockoverride "amenity_level_4_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('manpower_setting').GetValue, '(CFixedPoint)4')]"
									}
									blockoverride "amenity_level_4_tooltip" { tooltip = DEMD_MANPOWER_4_TOOLTIP }											
									
								}
							}
							flowcontainer = {	
								widget_county_amenity_right = { # public_order
									blockoverride "amenity_name" { text = "[Province.GetCounty.GetTitle.Custom('demd_public_order_edict_get_modifier')]" }
									blockoverride "amenity_icon_texture" { texture = "gfx/interface/window_roco_grandeur/icon_amenity_lodgings.dds" }
									blockoverride "amenity_level_int" { text = "[Province.GetCounty.GetTitle.MakeScope.Var('public_order_setting').GetValue|0]" } 
									
									# LEVEL 0
									blockoverride "amenity_level_0_effects" { 
										onclick = "[GetScriptedGui('demd_set_public_order_0').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_public_order_0').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_0_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_setting').GetValue, '(CFixedPoint)0')]"
									}
									blockoverride "amenity_level_0_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_setting').GetValue, '(CFixedPoint)0')]"
									}
									blockoverride "amenity_level_0_tooltip" { tooltip = DEMD_PUBLIC_ORDER_0_TOOLTIP }
									
									# LEVEL 1
									blockoverride "amenity_level_1_effects" { 
										onclick = "[GetScriptedGui('demd_set_public_order_1').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_public_order_1').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_1_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_setting').GetValue, '(CFixedPoint)1')]"
									}
									blockoverride "amenity_level_1_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_setting').GetValue, '(CFixedPoint)1')]"
									}
									blockoverride "amenity_level_1_tooltip" { tooltip = DEMD_PUBLIC_ORDER_1_TOOLTIP }
									
									# LEVEL 2
									blockoverride "amenity_level_2_effects" { 
										onclick = "[GetScriptedGui('demd_set_public_order_2').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_public_order_2').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_2_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_setting').GetValue, '(CFixedPoint)2')]"
									}
									blockoverride "amenity_level_2_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_setting').GetValue, '(CFixedPoint)2')]"
									}
									blockoverride "amenity_level_2_tooltip" { tooltip = DEMD_PUBLIC_ORDER_2_TOOLTIP }
									
									# LEVEL 3
									blockoverride "amenity_level_3_effects" { 
										onclick = "[GetScriptedGui('demd_set_public_order_3').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_public_order_3').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_3_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_setting').GetValue, '(CFixedPoint)3')]"
									}
									blockoverride "amenity_level_3_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_setting').GetValue, '(CFixedPoint)3')]"
									}
									blockoverride "amenity_level_3_tooltip" { tooltip = DEMD_PUBLIC_ORDER_3_TOOLTIP }
									
									# LEVEL 4
									blockoverride "amenity_level_4_effects" { 
										onclick = "[GetScriptedGui('demd_set_public_order_4').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_public_order_4').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_4_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_setting').GetValue, '(CFixedPoint)4')]"
									}
									blockoverride "amenity_level_4_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_setting').GetValue, '(CFixedPoint)4')]"
									}
									blockoverride "amenity_level_4_tooltip" { tooltip = DEMD_PUBLIC_ORDER_4_TOOLTIP }											
									
								}
								widget_county_amenity_left = { # sanitation
									blockoverride "amenity_name" { text = "[Province.GetCounty.GetTitle.Custom('demd_sanitation_edict_get_modifier')]" }
									blockoverride "amenity_icon_texture" { texture = "gfx/interface/window_roco_grandeur/icon_amenity_servants.dds" }
									blockoverride "amenity_level_int" { text = "[Province.GetCounty.GetTitle.MakeScope.Var('sanitation_setting').GetValue|0]" } 
									
									# LEVEL 0
									blockoverride "amenity_level_0_effects" { 
										onclick = "[GetScriptedGui('demd_set_sanitation_0').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_sanitation_0').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_0_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('sanitation_setting').GetValue, '(CFixedPoint)0')]"
									}
									blockoverride "amenity_level_0_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('sanitation_setting').GetValue, '(CFixedPoint)0')]"
									}
									blockoverride "amenity_level_0_tooltip" { tooltip = DEMD_SANITATION_0_TOOLTIP }
									
									# LEVEL 1
									blockoverride "amenity_level_1_effects" { 
										onclick = "[GetScriptedGui('demd_set_sanitation_1').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_sanitation_1').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_1_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('sanitation_setting').GetValue, '(CFixedPoint)1')]"
									}
									blockoverride "amenity_level_1_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('sanitation_setting').GetValue, '(CFixedPoint)1')]"
									}
									blockoverride "amenity_level_1_tooltip" { tooltip = DEMD_SANITATION_1_TOOLTIP }
									
									# LEVEL 2
									blockoverride "amenity_level_2_effects" { 
										onclick = "[GetScriptedGui('demd_set_sanitation_2').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_sanitation_2').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_2_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('sanitation_setting').GetValue, '(CFixedPoint)2')]"
									}
									blockoverride "amenity_level_2_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('sanitation_setting').GetValue, '(CFixedPoint)2')]"
									}
									blockoverride "amenity_level_2_tooltip" { tooltip = DEMD_SANITATION_2_TOOLTIP }
									
									# LEVEL 3
									blockoverride "amenity_level_3_effects" { 
										onclick = "[GetScriptedGui('demd_set_sanitation_3').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_sanitation_3').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_3_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('sanitation_setting').GetValue, '(CFixedPoint)3')]"
									}
									blockoverride "amenity_level_3_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('sanitation_setting').GetValue, '(CFixedPoint)3')]"
									}
									blockoverride "amenity_level_3_tooltip" { tooltip = DEMD_SANITATION_3_TOOLTIP }
									
									# LEVEL 4
									blockoverride "amenity_level_4_effects" { 
										onclick = "[GetScriptedGui('demd_set_sanitation_4').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_sanitation_4').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_4_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('sanitation_setting').GetValue, '(CFixedPoint)4')]"
									}
									blockoverride "amenity_level_4_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('sanitation_setting').GetValue, '(CFixedPoint)4')]"
									}
									blockoverride "amenity_level_4_tooltip" { tooltip = DEMD_SANITATION_4_TOOLTIP }											
									
								}
							}
							flowcontainer = {	
								widget_county_amenity_right = { # irrigation
									blockoverride "amenity_name" { raw_text = "[Province.GetCounty.GetTitle.Custom('demd_irrigation_edict_get_modifier')]" }
									blockoverride "amenity_icon_texture" { texture = "gfx/interface/window_roco_grandeur/icon_amenity_dining.dds" } 
									blockoverride "amenity_level_int" { text = "[Province.GetCounty.GetTitle.MakeScope.Var('irrigation_setting').GetValue|0]" } 
									
									# LEVEL 0
									blockoverride "amenity_level_0_effects" { 
										onclick = "[GetScriptedGui('demd_set_irrigation_0').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_irrigation_0').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_0_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('irrigation_setting').GetValue, '(CFixedPoint)0')]"
									}
									blockoverride "amenity_level_0_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('irrigation_setting').GetValue, '(CFixedPoint)0')]"
									}
									blockoverride "amenity_level_0_tooltip" { tooltip = DEMD_IRRIGATION_0_TOOLTIP }
									
									# LEVEL 1
									blockoverride "amenity_level_1_effects" { 
										onclick = "[GetScriptedGui('demd_set_irrigation_1').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_irrigation_1').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_1_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('irrigation_setting').GetValue, '(CFixedPoint)1')]"
									}
									blockoverride "amenity_level_1_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('irrigation_setting').GetValue, '(CFixedPoint)1')]"
									}
									blockoverride "amenity_level_1_tooltip" { tooltip = DEMD_IRRIGATION_1_TOOLTIP }
									
									# LEVEL 2
									blockoverride "amenity_level_2_effects" { 
										onclick = "[GetScriptedGui('demd_set_irrigation_2').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_irrigation_2').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_2_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('irrigation_setting').GetValue, '(CFixedPoint)2')]"
									}
									blockoverride "amenity_level_2_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('irrigation_setting').GetValue, '(CFixedPoint)2')]"
									}
									blockoverride "amenity_level_2_tooltip" { tooltip = DEMD_IRRIGATION_2_TOOLTIP }
									
									# LEVEL 3
									blockoverride "amenity_level_3_effects" { 
										onclick = "[GetScriptedGui('demd_set_irrigation_3').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_irrigation_3').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_3_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('irrigation_setting').GetValue, '(CFixedPoint)3')]"
									}
									blockoverride "amenity_level_3_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('irrigation_setting').GetValue, '(CFixedPoint)3')]"
									}
									blockoverride "amenity_level_3_tooltip" { tooltip = DEMD_IRRIGATION_3_TOOLTIP }
									
									# LEVEL 4
									blockoverride "amenity_level_4_effects" { 
										onclick = "[GetScriptedGui('demd_set_irrigation_4').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_irrigation_4').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_4_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('irrigation_setting').GetValue, '(CFixedPoint)4')]"
									}
									blockoverride "amenity_level_4_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('irrigation_setting').GetValue, '(CFixedPoint)4')]"
									}
									blockoverride "amenity_level_4_tooltip" { tooltip = DEMD_IRRIGATION_4_TOOLTIP }											
									
								}
								widget_county_amenity_left = { # infrastructure
									blockoverride "amenity_name" { raw_text = "[Province.GetCounty.GetTitle.Custom('demd_infrastructure_edict_get_modifier')]" }
									blockoverride "amenity_icon_texture" { texture = "gfx/interface/window_roco_grandeur/icon_amenity_lodgings.dds" } 
									blockoverride "amenity_level_int" { text = "[Province.GetCounty.GetTitle.MakeScope.Var('infrastructure_setting').GetValue|0]" } 
									
									# LEVEL 0
									blockoverride "amenity_level_0_effects" { 
										onclick = "[GetScriptedGui('demd_set_infrastructure_0').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_infrastructure_0').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_0_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('infrastructure_setting').GetValue, '(CFixedPoint)0')]"
									}
									blockoverride "amenity_level_0_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('infrastructure_setting').GetValue, '(CFixedPoint)0')]"
									}
									blockoverride "amenity_level_0_tooltip" { tooltip = DEMD_INFRASTRUCTURE_0_TOOLTIP }
									
									# LEVEL 1
									blockoverride "amenity_level_1_effects" { 
										onclick = "[GetScriptedGui('demd_set_infrastructure_1').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_infrastructure_1').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_1_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('infrastructure_setting').GetValue, '(CFixedPoint)1')]"
									}
									blockoverride "amenity_level_1_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('infrastructure_setting').GetValue, '(CFixedPoint)1')]"
									}
									blockoverride "amenity_level_1_tooltip" { tooltip = DEMD_INFRASTRUCTURE_1_TOOLTIP }
									
									# LEVEL 2
									blockoverride "amenity_level_2_effects" { 
										onclick = "[GetScriptedGui('demd_set_infrastructure_2').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_infrastructure_2').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_2_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('infrastructure_setting').GetValue, '(CFixedPoint)2')]"
									}
									blockoverride "amenity_level_2_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('infrastructure_setting').GetValue, '(CFixedPoint)2')]"
									}
									blockoverride "amenity_level_2_tooltip" { tooltip = DEMD_INFRASTRUCTURE_2_TOOLTIP }
									
									# LEVEL 3
									blockoverride "amenity_level_3_effects" { 
										onclick = "[GetScriptedGui('demd_set_infrastructure_3').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_infrastructure_3').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_3_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('infrastructure_setting').GetValue, '(CFixedPoint)3')]"
									}
									blockoverride "amenity_level_3_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('infrastructure_setting').GetValue, '(CFixedPoint)3')]"
									}
									blockoverride "amenity_level_3_tooltip" { tooltip = DEMD_INFRASTRUCTURE_3_TOOLTIP }
									
									# LEVEL 4
									blockoverride "amenity_level_4_effects" { 
										onclick = "[GetScriptedGui('demd_set_infrastructure_4').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
										enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_infrastructure_4').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									}
									blockoverride "amenity_level_4_visible_sunburst" { 
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('infrastructure_setting').GetValue, '(CFixedPoint)4')]"
									}
									blockoverride "amenity_level_4_visible_dot" {
										visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('infrastructure_setting').GetValue, '(CFixedPoint)4')]"
									}
									blockoverride "amenity_level_4_tooltip" { tooltip = DEMD_INFRASTRUCTURE_4_TOOLTIP }											
									
								}
							}
							
																
						}
					}
				}
				
                # DEMD Excavation Tab
                flowcontainer = {
					name = "excavation"
					parentanchor = hcenter
					
					spacing = 4
					# min_width = 70
					#parentanchor = top|right
					#ignoreinvisible = yes
					visible = "[GetVariableSystem.HasValue( 'demd_county_view', 'excavation_tab' )]"
					enabled = "[GetVariableSystem.HasValue( 'demd_county_view', 'excavation_tab' )]"
					#texture = "gfx/interface/component_masks/mask_rough_edges.dds"
					margin_top = 25
					margin_bottom = 25
					margin_left = 30
					margin_right = 30
					
	
					
					using = Background_Letter

					flowcontainer = {
						direction = vertical
				

						icon = {
							size = { 680 380 }
							background = {
								texture = "gfx/interface/component_tiles/tile_frame_subwindow_01.dds"
								spriteType = Corneredtiled
								spriteborder = { 20 20 }
								margin = { 7 7 }
								mirror = horizontal							
							}
							text_single = { #icon
								parentanchor = hcenter|vcenter
								size = { 100% 100% }
								text="[Province.GetCounty.GetTitle.Custom('get_ruins_backdrop')]" 
								default_format = "#SIZE:100"
							}
							# Excavation Start button
							flowcontainer = {
								parentanchor = center
								visible = "[GetScriptedGui('show_excavation_start_button').IsShown( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End)]"
								button_primary_big = {
									name = "start_excavation"
									size = { 200 40 }
									layoutpolicy_horizontal = expanding
									onclick = "[GetScriptedGui('start_excavation').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
									enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('start_excavation').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]"
									text = button_start_excavation
									tooltip = DEMD_START_EXCAVATION
								
								}
							}
							flowcontainer = {
								direction = vertical
								margin_left = -4
								margin_top = -5
								spacing = -3
								visible = "[GetScriptedGui('show_excavation_progress_bar').IsShown( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End)]"
								portrait_head = {
									#visible = "[GetScriptedGui('show_excavation_leader_head').IsShown( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End)]"
									datacontext = "[Province.GetCounty.GetTitle.MakeScope.Var('active_excavation').Story.MakeScope.Var('excavation_leader').GetCharacter]"
									size = { 98 120 }
									background = {
										using = Background_Area_Solid
									}
								}
								button_standard = {
									#parentanchor = hcenter
									
									size = { 97 30 }
									tooltip = EXCAVATION_REMOVE_LEADER_TOOLTIP
									text = button_replace_excavation_leader
									onclick = "[GetScriptedGui('remove_excavation_leader').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
									onclick = "[GetVariableSystem.Toggle( 'window_assign_excavation_leader' )]"
									onclick = "[GetScriptedGui('get_excavation_leader_candidates').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
									background = {
										using = Background_Area_Solid
									}
								}
							}
							
							# excavation bar
							flowcontainer = {
								direction = vertical
								parentanchor = bottom
								margin_bottom = 40
								visible = "[GetScriptedGui('show_excavation_progress_bar').IsShown( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End)]"
								widget = {
									name = "grandeur_tutorial_uses_this"
									parentanchor = center
									# Ensure a consistent background
									
									
									
									@progress_bar_size = 680
									@progress_bar_spacing = @[progress_bar_size / 20]
									@progress_bar_spacer_1 = @[progress_bar_size / 4]
									@progress_bar_spacer_2 = @[2 * progress_bar_size / 4]
									@progress_bar_spacer_3 = @[3 * progress_bar_size / 4]
									@progress_bar_spacer_4 = @[progress_bar_size]
									
									size = { @progress_bar_size 100% }
									allow_outside = yes
									
									progressbar_royal_court = {
										name = "background"
										size = { @progress_bar_size 40 }
										value = 0

									}
									
									progressbar_green = {
											name = "new_base_level"
											size = { @progress_bar_size 40 }
											min = 0
											max = "[FixedPointToProgressbarValue(Province.GetCounty.GetTitle.MakeScope.ScriptValue('excavation_progressbar_max'))]"
											value = "[FixedPointToProgressbarValue( Province.GetCounty.GetTitle.MakeScope.ScriptValue('excavation_progressbar_current_plus_delta'))]"

											#progresstexture = "gfx/interface/progressbars/blank.dds"
											#noprogresstexture = "gfx/interface/progressbars/blank.dds"


											marker = {
												name = "current_value"
												widget = {
													icon = {
														size = { 25 36 }
														position = { -20 2 }
														texture = "gfx/interface/progressbars/progressbar_center_glow.dds"
														color = { 0.9 0.9 0.9 1 }
													}
												}
											}
										}
						
									progressbar_royal_court = {
										parentanchor = hcenter
										name = "above_base_level"
										size = { @progress_bar_size 40 }
										min = 0
										max = "[FixedPointToProgressbarValue(Province.GetCounty.GetTitle.MakeScope.ScriptValue('excavation_progressbar_max'))]"
										value = "[FixedPointToProgressbarValue( Province.GetCounty.GetTitle.MakeScope.ScriptValue('excavation_progressbar_current'))]"
										alpha = 0.7
										#tooltip = EXCAVATION_BAR_TOOLTIP
										#datacontext = "[GuiScope.SetRoot(Province.GetCounty.GetTitle.MakeScope).GetScriptValueBreakdown('demd_amenity_level_current')]"
										tooltipwidget = { 
                                            excavation_breakdown_widget = { 
                                            
                                            } 
                                        }

										marker = {
											name = "current_value"
											widget = {
												icon = {
													size = { 25 36 }
													position = { -20 2 }
													texture = "gfx/interface/progressbars/progressbar_center_glow.dds"
													color = { 0.75 0.89 0.97 0.9 }
												}
												icon = {
													name = "current_value_divider"
													size = { 12 50 }
													position = { -5 -5 }
													texture = "gfx/interface/window_roco_grandeur/grandeur_bar_base_level.dds"
												}
											}
										}
										
										
									}
									
									
									
									flowcontainer = {
										name = "level_dividers"
										position = { 0 6 }
										allow_outside = yes
										
										widget_amenity_level_divider = {
											blockoverride "position" { position = { @progress_bar_spacer_1 14 } }
										}
										widget_amenity_level_divider = {
											blockoverride "position" { position = { @progress_bar_spacer_2 14 } }
										}
										widget_amenity_level_divider = {
											blockoverride "position" { position = { @progress_bar_spacer_3 14 } }
										}
										widget_amenity_level_divider = {
											blockoverride "position" { position = { @progress_bar_spacer_4 14 } }
										}
										widget_amenity_level_marker = { 								
											blockoverride "position" { position = { 0 -28 } }
											
											blockoverride "current_level_equals_this" { visible = "[EqualTo_CFixedPoint( '(CFixedPoint)1', Province.GetCounty.GetTitle.MakeScope.ScriptValue('excavation_stage_display'))]" }									
											blockoverride "current_level" { raw_text = "1" }
											blockoverride "tooltip" { tooltip = excavation_stage_intermediate_tt }	
										}
										widget_amenity_level_marker = { 								
											blockoverride "position" { position = { @progress_bar_spacer_1 -28 } }
											
											blockoverride "current_level_equals_this" { visible = "[EqualTo_CFixedPoint( '(CFixedPoint)2', Province.GetCounty.GetTitle.MakeScope.ScriptValue('excavation_stage_display'))]" }									
											blockoverride "current_level" { raw_text = "2" }
											blockoverride "tooltip" { tooltip = excavation_stage_intermediate_tt }								
										}
										widget_amenity_level_marker = { 								
											blockoverride "position" { position = { @progress_bar_spacer_2 -28 } }
											
											blockoverride "current_level_equals_this" { visible = "[EqualTo_CFixedPoint( '(CFixedPoint)3', Province.GetCounty.GetTitle.MakeScope.ScriptValue('excavation_stage_display'))]" }									
											blockoverride "current_level" { raw_text = "3" }
											blockoverride "tooltip" { }								
										}
										widget_amenity_level_marker = { 								
											blockoverride "position" { position = { @progress_bar_spacer_3 -28 } }
											
											blockoverride "current_level_equals_this" { visible = "[EqualTo_CFixedPoint( '(CFixedPoint)4', Province.GetCounty.GetTitle.MakeScope.ScriptValue('excavation_stage_display'))]" }									
											blockoverride "current_level" { raw_text = "4" }
											blockoverride "tooltip" { }								
										}
										widget_amenity_level_marker = { 								
											blockoverride "position" { position = { @progress_bar_spacer_4 -28 } }
											
											blockoverride "current_level_equals_this" { visible = "[EqualTo_CFixedPoint( '(CFixedPoint)5', Province.GetCounty.GetTitle.MakeScope.ScriptValue('excavation_stage_display'))]" }									
											blockoverride "current_level" { raw_text = "5" }
											blockoverride "tooltip" { }								
										}
									}
									
									icon = {
										name = "grandeur_bar_bracket_left"
										texture = "gfx/interface/window_roco_grandeur/grandeur_bar_bracket_left.dds"
										size = { 29 60 }
										position = { -10 -10 }
										parentanchor = left
									}

									icon = {
										name = "grandeur_bar_bracket_right"
										texture = "gfx/interface/window_roco_grandeur/grandeur_bar_bracket_right.dds"
										size = { 29 60 }
										position = { 10 -10 }
										parentanchor = right
									}
								}						
							}
								
						}																		
					}
				}
		
            
		}
	}
}

######################################################
########### CONSTRUCT NEW BUILDING WINDOW ############
######################################################

window = {
	name = "holding_tracks_view"
	size = { 100% 100% }
	movable = no
	layer = windows_layer
	datacontext = "[HoldingView.GetHolder]"

	state = {
		name = _show
		using = Animation_FadeIn_Quick
		position_x = 160
	}

	state = {
		name = _hide
		using = Animation_FadeOut_Quick
		position_x = -50
	}

	alwaystransparent = yes

	hbox = {
		expand = {
			max_width = 610
		}

		widget = {
			layoutpolicy_vertical = expanding
			size = { 670 0 }

			vbox = {
				margin_top = 170
				margin_bottom = 10

				expand = {}

				vbox = {
					layoutpolicy_horizontal = expanding
					minimumsize = { 0 700 }

					## New Building
					vbox = {
						visible = "[Not(HoldingView.IsSelectingBuildingToConstruct)]"
						layoutpolicy_horizontal = expanding
						alwaystransparent = no
						margin = { 3 3 }
						margin_bottom = 5
						using = Window_Background_Subwindow

						header_pattern = {
							layoutpolicy_horizontal = expanding

							blockoverride "header_text"
							{
								text = "[HoldingView.GetTracksViewLabel]"
							}

							blockoverride "button_close"
							{
								onclick = "[HoldingView.CloseSubwindows]"
							}
						}

						building_in_vassal_warning_hbox = {}

						text_single = {
							layoutpolicy_horizontal = shrinking
							name = "prompt"
							text = "[HoldingView.GetTracksViewPrompt]"
							margin_bottom = 10
						}

						text_single = {
							visible = "[IsDataModelEmpty(HoldingView.GetPotentialBuildings)]"
							layoutpolicy_horizontal = shrinking
							name = "no_potential_buildings_text"
							text = "NO_POTENTIAL_BUILDINGS_WARNING"
							margin_bottom = 10
						}

						## Construct New Building
						container = {
							visible = "[Not(IsDataModelEmpty(HoldingView.GetPotentialBuildings))]"
							layoutpolicy_vertical = expanding

							scrollbox = {
								visible = "[Not(HoldingView.IsSelectingBuildingToConstruct)]"
								size = { 700 300 }
								autoresizescrollarea = yes
								maximumsize = { -1 800 }

								blockoverride "scrollbox_content"
								{
									name = "tracks_grid"
									datamodel = "[HoldingView.GetPotentialBuildings]"
									datacontext = "[HoldingView.GetProvince]"
									datacontext = "[HoldingView.GetProvince.GetCounty.GetCulture]"
									visible = "[HoldingView.IsSelectingNewBuilding]"
									spacing = 10
									set_parent_size_to_minimum = yes

									block "scrollbox_margins"
									{
										using = Scrollbox_Margins
										margin_right = 15
										margin_top = 5
									}

									item = {
										vbox = {
											layoutpolicy_horizontal = expanding

											background = {
												using = Background_Area_Light
											}

											hbox = {
												name = "header"
												layoutpolicy_horizontal = expanding

												background = {
													using = Background_Area
												}

												hbox = {
													layoutpolicy_horizontal = expanding
													margin = { 10 10 }
													spacing = 10

													icon_building = {
														name = "building_icon"
														size = { 75 65 }
														texture = "[GUIPotentialBuildingItem.GetBuilding.GetTypeIcon]"
													}

													vbox = {
														spacing = 5
														layoutpolicy_horizontal = expanding
														
														text_single = {
															layoutpolicy_horizontal = expanding
															text = "[GUIPotentialBuildingItem.GetBuilding.GetTypeName]"
															using = Font_Size_Medium
															align = left
															autoresize = no
														}

														hbox = {
															button_tertiary = {
																text = "CONSTRUCT_BUILDINGS_DETAILS"

																onclick = "[GUIPotentialBuildingItem.ShowDetails]"
																tooltip = "CONSTRUCT_BUILDINGS_DETAILS_TT"
																using = tooltip_es
															}

															expand = {}
														}
													}

													expand = {}

													hbox = {
														spacing = 5

														hbox = {
															margin = { 5 5 }
															min_width = 120
															spacing = 10

															background = {
																using = Background_Area
																margin_bottom = 4
																margin_left = 6
															}

															text_single = {
																datacontext = "[GUIPotentialBuildingItem.GetGoldCost]"
																visible = "[GUIPotentialBuildingItem.HasGoldCost]"
																layoutpolicy_horizontal = expanding
																text = "[ValueBreakdown.GetValue]"
																tooltip_visible = "[ValueBreakdown.HasTooltip]"

																tooltipwidget = {
																	widget_value_breakdown_tooltip = {}
																}

																background = {
																	visible = "[LessThan_CFixedPoint(GetPlayer.GetGold, ValueBreakdown.GetFixedPointValue)]"
																	using = Status_Bad
																}
															}

															text_single = {
																datacontext = "[GUIPotentialBuildingItem.GetPrestigeCost]"
																visible = "[GUIPotentialBuildingItem.HasPrestigeCost]"
																layoutpolicy_horizontal = expanding
																text = "[ValueBreakdown.GetValue]"
																tooltip_visible = "[ValueBreakdown.HasTooltip]"

																tooltipwidget = {
																	widget_value_breakdown_tooltip = {}
																}

																background = {
																	visible = "[LessThan_CFixedPoint(GetPlayer.GetPrestige, ValueBreakdown.GetFixedPointValue)]"
																	using = Status_Bad
																}
															}

															text_single = {
																layoutpolicy_horizontal = expanding
																datacontext = "[GUIPotentialBuildingItem.GetPietyCost]"
																visible = "[GUIPotentialBuildingItem.HasPietyCost]"
																text = "[ValueBreakdown.GetValue]"
																tooltip_visible = "[ValueBreakdown.HasTooltip]"

																tooltipwidget = {
																	widget_value_breakdown_tooltip = {}
																}

																background = {
																	visible = "[LessThan_CFixedPoint(GetPlayer.GetPiety, ValueBreakdown.GetFixedPointValue)]"
																	using = Status_Bad
																}
															}

															text_single = {
																layoutpolicy_horizontal = expanding
																datacontext = "[GUIPotentialBuildingItem.GetConstructionTime]"
																text = "[ValueBreakdown.GetValue]"
																tooltip_visible = "[ValueBreakdown.HasTooltip]"

																tooltipwidget = {
																	widget_value_breakdown_tooltip = {}
																}
															}

															expand = {}
														}

														button_standard = {
															layoutpolicy_horizontal = expanding
															layoutpolicy_vertical = expanding
															size = { 100 53 }
															enabled = "[GUIPotentialBuildingItem.CanConstruct]"
															tooltip = "[GUIPotentialBuildingItem.GetTooltip]"
															onclick = "[GUIPotentialBuildingItem.Construct]"
															text = "CONSTRUCT"
															using = tooltip_es
														}
													}
												}
											}

											hbox = {
												name = "dynamic_content"
												layoutpolicy_horizontal = expanding
												margin = {5 5}

												text_multi = {
													layoutpolicy_horizontal = expanding
													layoutpolicy_vertical = expanding
													margin = {5 0}
													text = "[GUIPotentialBuildingItem.GetBuilding.GetTypeDescription]"
													default_format = "#F"
													autoresize = yes
													max_width = 280
													min_width = 280
												}

												vbox = {
													spacing = 8

													hbox = {
														layoutpolicy_horizontal = expanding
														margin_left = 10

														text_label_left = {
															layoutpolicy_horizontal = expanding
															datacontext = "[GUIPotentialBuildingItem.GetBuilding]"
															text = CV_BUILDING_LEVEL_AND_NAME
															autoresize = no
														}
													}

													text_multi = {
														layoutpolicy_horizontal = expanding
														layoutpolicy_vertical = expanding
														autoresize = yes
														max_width = 355
														min_width = 355
														text = "[GUIPotentialBuildingItem.GetBuilding.GetEffectDescriptionAtProvince( Character.Self, Province.Self )]"
														margin = { 15 10 }

														background = {
															using = Background_Frame
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}

					vbox = {
						vbox = {
							visible = "[HoldingView.IsSelectingBuildingToConstruct]"
							layoutpolicy_horizontal = expanding
							alwaystransparent = no

							## Upgrade Building
							vbox = {
								name = "upgrade"
								datacontext = "[HoldingView.GetTrack]"
								layoutpolicy_horizontal = expanding
								#minimumsize = { 0 700 }
								using = Window_Background_Subwindow
								margin_bottom = 10

								hbox = {
									layoutpolicy_horizontal = expanding
									margin = { 15 10 }
									spacing = 10

									background = {
										using = Background_Area
									}

									icon_building = {
										name = "building_icon"
										texture = "[GUITrackItem.GetSelectedBuilding.GetTypeIcon]"
									}

									vbox = {
										layoutpolicy_horizontal = expanding

										text_single = {
											layoutpolicy_horizontal = expanding
											text = "[GUITrackItem.GetSelectedBuilding.GetTypeName]"
											using = Font_Size_Big
											default_format = "#high"
										}

										text_single = {
											layoutpolicy_horizontal = expanding
											text = "[GUITrackItem.GetBuildingTypeText]"
										}

										building_in_vassal_warning_hbox = {
										}
									}

									buttons_window_control = {
										blockoverride "button_close"
										{
											onclick = "[HoldingView.CloseSubwindows]"
										}
									}
								}

								vbox = {
									layoutpolicy_horizontal = expanding
									layoutpolicy_vertical = expanding
									margin = { 15 5 }

									hbox = {
										layoutpolicy_horizontal = expanding
										margin = { 5 10 }

										### PREVIOUS BUILDINGS
										hbox = {
											name = "level_track_previous"
											datamodel = "[GUITrackItem.GetPreLevelItems]"

											item = {
												hbox = {
													button_icon = {
														name = "track_icon"
														onclick = "[BuildingLevelItem.OnClick]"
														down = "[BuildingLevelItem.IsSelected]"
														alwaystransparent = "[BuildingLevelItem.IsSelected]"

														size = { 60 60 }
														texture = "gfx/interface/buttons/button_round_big.dds"

														tooltip = "[BuildingLevelItem.GetTooltip]"
														using = tooltip_ne
														tooltip_offset = { 40 0 }

														background = {
															texture = "gfx/interface/window_county/building_status_circle.dds"
															framesize = { 120 120 }
															using = Master_Button_Modify_Texture

															blockoverride "master_color_frame" {
																frame = 3
															}
														}

														button_icon_highlight = {
															name = "level_icon"
															parentanchor = center
															size = { 41 24 }
															down = "[BuildingLevelItem.IsSelected]"
															texture = "[BuildingLevelItem.GetIcon]"
														}

														icon = {
															visible = "[BuildingLevelItem.IsSelected]"
															parentanchor = bottom|hcenter
															position = { 0 8 }
															texture = "gfx/interface/window_county/building_selected_arrow.dds"
															size = { 18 12 }
															using = Master_Button_Modify_Texture

															blockoverride "master_color_frame" {
																frame = 2
															}
														}
													}

													widget = {
														visible = "[GUITrackItem.HasCurrentBuilding]"
														layoutpolicy_horizontal = expanding
														size = { 5 6 }

														background = {
															texture = "gfx/interface/icons/building_types/building_buttons_connector.dds"
															margin = { 2 0 }

															using = Master_Button_Modify_Texture

															blockoverride "master_color_frame" {
																frame = 1
															}
														}
													}
												}
											}
										}

										### CURRENT BUILDING
										button_icon = {
											name = "current_building"
											visible = "[GUITrackItem.HasCurrentBuilding]"
											onclick = "[GUITrackItem.OnCurrentBuildingClick]"
											down = "[GUITrackItem.IsCurrentBuildingSelected]"
											alwaystransparent = "[GUITrackItem.IsCurrentBuildingSelected]"
											tooltip = "[GUITrackItem.GetCurrentBuildingTooltip]"
											using = tooltip_ws
											size = { 60 60 }
											texture = "gfx/interface/buttons/button_round_big.dds"
											using = tooltip_ne
											tooltip_offset = { 40 0 }

											background = {
												texture = "gfx/interface/window_county/building_status_circle.dds"
												framesize = { 120 120 }
												using = Master_Button_Modify_Texture

												blockoverride "master_color_frame" {
													frame = 3
												}
											}

											button_icon_highlight = {
												name = "level_icon"
												parentanchor = center
												size = { 41 24 }
												down = "[GUITrackItem.IsCurrentBuildingSelected]"
												texture = "[GUITrackItem.GetCurrentLevelIcon]"
											}

											icon = {
												visible = "[GUITrackItem.IsCurrentBuildingSelected]"
												parentanchor = bottom|hcenter
												position = { 0 8 }
												texture = "gfx/interface/window_county/building_selected_arrow.dds"
												size = { 18 12 }
												using = Master_Button_Modify_Texture

												blockoverride "master_color_frame" {
													frame = 2
												}
											}
										}

										expand = {
											visible = "[Not(And(GUITrackItem.HasCurrentBuilding, GUITrackItem.HasNextBuilding))]"
										}

										widget = {
											visible = "[And(GUITrackItem.HasCurrentBuilding, GUITrackItem.HasNextBuilding)]"
											layoutpolicy_horizontal = expanding
											size = { 5 6 }

											background = {
												texture = "gfx/interface/icons/building_types/building_buttons_connector.dds"
												margin = { 2 0 }
												using = Master_Button_Modify_Texture

												blockoverride "master_color_frame" {
													frame = 1
												}
											}
										}

										### NEXT BUILDING
										button_icon = {
											name = "next_building"
											visible = "[GUITrackItem.HasNextBuilding]"
											down = "[GUITrackItem.IsNextBuildingSelected]"
											alwaystransparent = "[GUITrackItem.IsNextBuildingSelected]"
											size = { 60 60 }
											texture = "gfx/interface/buttons/button_round_big.dds"
											onclick = "[GUITrackItem.OnNextBuildingClick]"
											tooltip = "[GUITrackItem.GetNextBuildingTooltip]"
											using = tooltip_ne
											tooltip_offset = { 40 0 }

											background = {
												visible = "[GUITrackItem.IsConstructing]"
												texture = "gfx/interface/window_county/building_status_circle.dds"
												framesize = { 120 120 }
												frame = 2
												alpha = 0.5
												using = Master_Button_Modify_Texture

												blockoverride "master_color_frame" {
													frame = 4
												}
											}

											button_icon_highlight = {
												name = "level_icon"
												parentanchor = center
												size = { 41 24 }
												down = "[GUITrackItem.IsNextBuildingSelected]"
												alwaystransparent = yes
												texture = "[GUITrackItem.GetNextLevelIcon]"
												#frame = "[GUITrackItem.GetNextLevelIconFrame]"
											}

											icon = {
												visible = "[GUITrackItem.IsNextBuildingSelected]"
												parentanchor = bottom|hcenter
												position = { 0 8 }
												texture = "gfx/interface/window_county/building_selected_arrow.dds"
												size = { 18 12 }
												using = Master_Button_Modify_Texture

												blockoverride "master_color_frame" {
													frame = 2
												}
											}
										}

										widget = {
											visible = "[Not(IsDataModelEmpty( GUITrackItem.GetPostLevelItems ))]"
											layoutpolicy_horizontal = expanding
											size = { 5 6 }

											background = {
												texture = "gfx/interface/icons/building_types/building_buttons_connector.dds"
												margin = { 2 0 }
												using = Master_Button_Modify_Texture

												blockoverride "master_color_frame" {
													frame = 1
												}
											}
										}

										#Post Track
										### LEVEL TRACK
										hbox = {
											name = "level_track_next"
											datamodel = "[GUITrackItem.GetPostLevelItems]"

											item = {
												hbox = {
													widget = {
														layoutpolicy_horizontal = expanding
														size = { 5 6 }

														background = {
															texture = "gfx/interface/icons/building_types/building_buttons_connector.dds"
															margin = { 2 0 }
															using = Master_Button_Modify_Texture

															blockoverride "master_color_frame" {
																frame = 1
															}
														}
													}

													button_icon = {
														down = "[BuildingLevelItem.IsSelected]"
														alwaystransparent = "[BuildingLevelItem.IsSelected]"
														size = { 60 60 }
														texture = "gfx/interface/buttons/button_round_big.dds"
														onclick = "[BuildingLevelItem.OnClick]"
														tooltip = "[BuildingLevelItem.GetTooltip]"
														using = tooltip_ne
														tooltip_offset = { 40 0 }

														button_icon_highlight = {
															name = "level_icon"
															parentanchor = center
															size = { 41 24 }
															down = "[BuildingLevelItem.IsSelected]"
															texture = "[BuildingLevelItem.GetIcon]"
															# frame = 2
														}

														icon = {
															visible = "[BuildingLevelItem.IsSelected]"
															parentanchor = bottom|hcenter
															position = { 0 8 }
															texture = "gfx/interface/window_county/building_selected_arrow.dds"
															size = { 18 12 }
															using = Master_Button_Modify_Texture

															blockoverride "master_color_frame" {
																frame = 2
															}
														}
													}
												}
											}
										}
									}

									spacer = {
										size = { 10 10 }
									}

									# Buliding info
									vbox = {
										layoutpolicy_horizontal = expanding

										background = {
											using = Background_Frame
										}

										hbox = {
											layoutpolicy_horizontal = expanding
											margin_top = 5
											margin_left = 15

											text_label_left = {
												layoutpolicy_horizontal = expanding
												text = "[GUITrackItem.GetSelectedBuilding.GetNameNoTooltip]"
												default_format = "#high"
												using = Font_Size_Medium
											}
										}

										hbox = {
											name = "flavor_and_effect"
											layoutpolicy_horizontal = expanding
											layoutpolicy_vertical = expanding
											margin = { 5 5 }

											vbox = {
												layoutpolicy_horizontal = expanding
												layoutpolicy_vertical = expanding

												text_multi = {
													layoutpolicy_horizontal = expanding
													layoutpolicy_vertical = expanding
													margin = { 10 5 }
													autoresize = yes
													max_width = 330
													min_width = 330
													text = "[GUITrackItem.GetSelectedBuilding.GetDescription]"
												}

												hbox = {
													visible = "[And( And( Or( GUITrackItem.CanReplace, GUITrackItem.CanCancel ), GUITrackItem.IsCurrentBuildingSelected), Not( GUITrackItem.IsConstructing ) )]"
													spacing = 10
													margin_bottom = 5

													text_single = {
														text = "CURRENT_BUILDING"
														default_format = "#weak"
														align = nobaseline
													}
												}

												vbox = {
													visible = "[And(And(GreaterThan_int32(GUITrackItem.GetSelectedBuilding.GetLevel,GUITrackItem.GetCurrentBuilding.GetLevel),GreaterThan_int32(GUITrackItem.GetSelectedBuilding.GetLevel,'(int32)1')), Not(GUITrackItem.IsNextBuildingSelected))]"
													layoutpolicy_horizontal = expanding
													margin_left = 10
													margin_bottom = 5
													spacing = 5

													text_label_left = {
														layoutpolicy_horizontal = expanding
														text = "UPGRADE_COST"
													}

													hbox = {
														layoutpolicy_horizontal = expanding
														spacing = 10
														margin = { 10 10 }

														hbox = {
															spacing = 10

															text_single = {
																datacontext = "[GUITrackItem.GetSelectedGoldCost]"
																visible = "[GUITrackItem.HasSelectedGoldCost]"
																text = "[ValueBreakdown.GetValue]"
																align = nobaseline
																tooltip_visible = "[ValueBreakdown.HasTooltip]"

																tooltipwidget = {
																	widget_value_breakdown_tooltip = {}
																}

																background = {
																	visible = "[LessThan_CFixedPoint(GetPlayer.GetGold, ValueBreakdown.GetFixedPointValue)]"
																	using = Status_Bad
																}
															}

															text_single = {
																datacontext = "[GUITrackItem.GetSelectedPrestigeCost]"
																visible = "[GUITrackItem.HasSelectedPrestigeCost]"
																text = "[ValueBreakdown.GetValue]"
																align = nobaseline
																tooltip_visible = "[ValueBreakdown.HasTooltip]"

																tooltipwidget = {
																	widget_value_breakdown_tooltip = {}
																}
															}

															text_single = {
																datacontext = "[GUITrackItem.GetSelectedPietyCost]"
																visible = "[GUITrackItem.HasSelectedPietyCost]"
																text = "[ValueBreakdown.GetValue]"
																align = nobaseline
																tooltip_visible = "[ValueBreakdown.HasTooltip]"

																tooltipwidget = {
																	widget_value_breakdown_tooltip = {}
																}
															}

															text_single = {
																datacontext = "[GUITrackItem.GetSelectedConstructionTime]"
																text = "[ValueBreakdown.GetValue]"
																align = nobaseline
																tooltip_visible = "[ValueBreakdown.HasTooltip]"

																tooltipwidget = {
																	widget_value_breakdown_tooltip = {}
																}
															}
														}

														warning_icon = {
															name = "cant_construct"
															size = { 30 30 }
															tooltip = "[GUITrackItem.GetSelectedBuildingBlockReasons]"
															visible = "[Not(GUITrackItem.CanConstructSelectedBuilding)]"
														}

														expand = {}
													}
												}

											}

											divider_light = {
												layoutpolicy_vertical = expanding
											}

											text_multi = {
												datacontext = "[HoldingView.GetProvince.GetCounty.GetCulture]"
												layoutpolicy_horizontal = expanding
												layoutpolicy_vertical = expanding
												autoresize = yes
												max_width = 355
												min_width = 355
												text = "[GUITrackItem.GetSelectedBuilding.GetEffectDescriptionAtProvince( Character.Self, HoldingView.GetProvince )]"
												margin = { 15 10 }
											}
										}
									}

									vbox = {
										visible = "[GUITrackItem.IsConstructing]"
										layoutpolicy_horizontal = expanding
										margin = { 0 15 }
										spacing = 10

										text_single = {
											text = "HOLDING_VIEW_IN_PROGRESS"
											margin = { 0 5 }
										}

										hbox = {
											spacing = 10

											hbox = {
												widget = {
													size = { 20 20 }

													button_round  = {
														name = "abort_button"
														parentanchor = center
														visible = "[GUITrackItem.CanShowCancel]"
														enabled = "[GUITrackItem.CanCancel]"
														onclick = "[GUITrackItem.Cancel]"
														tooltip = "[GUITrackItem.GetCancelTooltip]"

														button_cancel = {
															parentanchor = center
															alwaystransparent = yes
														}
													}
												}
											}

											progressbar_standard = {
												name = "construct_progressbar"
												layoutpolicy_horizontal = expanding
												layoutstretchfactor_horizontal = 1
												size = { 300 25 }
												alwaystransparent = yes
												value = "[GUITrackItem.GetConstructionProgress]"

												text_single = {
													parentanchor = center
													text = "[GUITrackItem.GetConstructTimeLeft]"
													default_format = "#high"
													align = nobaseline
												}
											}
										}
									}

									spacing = 5

									hbox = {
										visible = "[Not(GUITrackItem.IsConstructing)]"
										spacing = 10
										# layoutpolicy_horizontal = expanding
										margin = { 10 10 }

										vbox = {
											layoutpolicy_vertical = expanding

											expand = {}

											button_standard_back = {
												name = "back_button"
												text = "BACK_LABEL"
												visible = "[And(EqualTo_int32(GUITrackItem.GetNextBuilding.GetLevel,'(int32)1'), Not(GUITrackItem.IsConstructing))]"
												onclick = "[GUITrackItem.GoBack]"
												oversound = "event:/SFX/UI/Generic/sfx_ui_generic_pointer_over"
												clicksound = "event:/SFX/UI/Generic/sfx_ui_generic_close"
											}

											button_round = {
												name = "replace_button"
												onclick = "[GUITrackItem.Replace]"
												tooltip = "[GUITrackItem.GetReplaceTooltip]"
												visible = "[And(GUITrackItem.IsCurrentBuildingSelected, GUITrackItem.CanReplace)]"

												button_change = {
													alwaystransparent = yes
													parentanchor = center
												}
											}
										}
										vbox = {
											spacing = 10

											hbox = {
												visible = "[GUITrackItem.HasNextBuilding]"
												layoutpolicy_horizontal = expanding

												hbox = {
													margin = { 10 5 }
													margin_right = 15
													spacing = 10

													background = {
														using = Background_Area
														margin_bottom = 4
														margin_left = 6
													}

													text_single = {
														datacontext = "[GUITrackItem.GetNextGoldCost]"
														visible = "[GUITrackItem.HasNextGoldCost]"
														text = "[ValueBreakdown.GetValue]"
														tooltip_visible = "[ValueBreakdown.HasTooltip]"

														tooltipwidget = {
															widget_value_breakdown_tooltip = {}
														}

														background = {
															visible = "[LessThan_CFixedPoint(GetPlayer.GetGold, ValueBreakdown.GetFixedPointValue)]"
															using = Status_Bad
														}
													}

													text_single = {
														datacontext = "[GUITrackItem.GetNextPrestigeCost]"
														visible = "[GUITrackItem.HasNextPrestigeCost]"
														text = "[ValueBreakdown.GetValue]"
														tooltip_visible = "[ValueBreakdown.HasTooltip]"

														tooltipwidget = {
															widget_value_breakdown_tooltip = {}
														}

														background = {
															visible = "[LessThan_CFixedPoint(GetPlayer.GetPrestige, ValueBreakdown.GetFixedPointValue)]"
															using = Status_Bad
														}
													}


													hbox = {
														layoutpolicy_horizontal = expanding
														datacontext = "[GUITrackItem.GetNextPietyCost]"
														visible = "[GUITrackItem.HasNextPietyCost]"

														text_single = {
															text = "[ValueBreakdown.GetValue]"
															tooltip_visible = "[ValueBreakdown.HasTooltip]"

															tooltipwidget = {
																widget_value_breakdown_tooltip = {}
															}
														}

														text_single = {
															visible = "[LessThan_CFixedPoint(GetPlayer.GetPiety, ValueBreakdown.GetFixedPointValue)]"
															raw_text = "@warning_icon!"
														}

														expand = {}
													}

													text_single = {
														layoutpolicy_horizontal = expanding
														datacontext = "[GUITrackItem.GetNextConstructionTime]"
														text = "[ValueBreakdown.GetValue]"
														tooltip_visible = "[ValueBreakdown.HasTooltip]"

														tooltipwidget = {
															widget_value_breakdown_tooltip = {}
														}
													}
												}
											}

											button_primary = {
												#	layoutpolicy_vertical = expanding
												#	layoutpolicy_horizontal = expanding
												#	size = { 250 53 }
												onclick = "[GUITrackItem.OnClick]"
												tooltip = "[GUITrackItem.GetNextBuildingTooltip]"
												enabled = "[GUITrackItem.CanConstructNextBuilding]"
												visible = "[GUITrackItem.HasNextBuilding]"
												text = "[SelectLocalization(EqualTo_int32(GUITrackItem.GetNextBuilding.GetLevel, '(int32)1'),'CONSTRUCT','UPGRADE')]"
												#	using = Font_Size_Medium
											}

										}
									}
								}
							}
						}

						expand = {}
					}

					expand = {}
				}
			}
		}

		expand = {}
	}
}

######################################################
############ HOLDING TYPE SELECTION VIEW #############
######################################################

window = {
	name = "holding_type_selection_view"
	movable = no
	layer = windows_layer
	parentanchor = bottom|hcenter
	position = { 40 -50 }
	using = Animation_ShowHide_Quick
	
	using = Window_Background_Subwindow
	
	vbox = {
		set_parent_size_to_minimum = yes
		margin = { 4 4 }
		margin_bottom = 15
		spacing = 15

		header_pattern = {
			layoutpolicy_horizontal = expanding

			blockoverride "header_text"
			{
				text = "CREATE_NEW_HOLDING_HEADING"
			}

			blockoverride "button_close"
			{
				onclick = "[HoldingView.CloseHoldingConstruction]"
			}
		}

		building_in_vassal_warning_hbox = {}

		hbox = {
			name = "holding_types"
			datamodel = "[HoldingView.GetHoldingTypeItems]"
			layoutpolicy_horizontal = expanding
			spacing = 10
			margin = { 10 10 }

			item = {
				vbox = {
					spacing = 5

					button_standard = {
						size = { 250 148 }
						enabled = "[HoldingTypeItem.CanConstructBuilding]"
						onclick = "[HoldingTypeItem.OnClick]"
						tooltip = "[HoldingTypeItem.GetTooltip]"
						datacontext = "[HoldingTypeItem.GetProvince]"

						widget = {
							scissor = yes
							size = { 247 146 }

							icon = {
								visible = "[HoldingTypeItem.CanConstructBuilding]"
								size = { 320 146 }
								texture = "[HoldingTypeItem.GetBuilding.GetIllustration(Province.Self)]"
								using = Mask_Rough_Edges
								alpha = 0.7
							}

							highlight_icon = {
								visible = "[Not(HoldingTypeItem.CanConstructBuilding)]"
								size = { 320 146 }
								texture = "[HoldingTypeItem.GetBuilding.GetIllustration(Province.Self)]"
								effectname = "GreyedOut"
								tintcolor = { 0.6 0.6 0.6 1 }
								using = Mask_Rough_Edges
							}
						}

						flowcontainer = {
							parentanchor = bottom|right
							ignoreinvisible = yes
							margin = { 5 5 }

							warning_icon = {
								name = "wrong_type"
								visible = "[Not(HoldingTypeItem.IsValidForPlayer)]"
								size = { 35 35 }
								tooltip = HOLDING_SELECTION_VIEW_WRONG_HOLDING_TYPE
							}
						}
					}

					text_label_center = {
						layoutpolicy_horizontal = expanding
						text = "[HoldingTypeItem.GetHoldingType.GetName]"
					}
				}
			}
		}
	}
}

######################################################
################ TYPES AND TEMPLATES #################
######################################################

types CountyViewTypes
{
	type widget_building_item = widget {
		parentanchor = bottom
		size = { 55 55 }
		enabled = "[GUIBuildingItem.IsBuildingButtonEnabled]"
		tooltip = "[GUIBuildingItem.GetTooltip]"
		using = tooltip_ne

		button_standard = {
			name = "building_button"
			size = { 100% 100% }
			onclick = "[GUIBuildingItem.OnClick]"
			down = "[GUIBuildingItem.IsHighlighted]"

			highlight_icon = {
				name = "build_new_icon"
				visible = "[And(And(GUIBuildingItem.IsBuildNewIconShown, GUIBuildingItem.IsBuildingButtonEnabled), Not(GUIBuildingItem.HasLevel))]"
				parentanchor = center
				size = { 28 28 }
				alpha = 0.7
				texture = "gfx/interface/icons/symbols/icon_plus.dds"
			}

			icon_building = {
				name = "building_icon"
				visible = "[Not( GUIBuildingItem.CanUpgrade )]"
				parentanchor = center
				size = { 40 40 }
				texture = "[GUIBuildingItem.GetCurrentOrConstrucingBuilding.GetTypeIcon]"
			}

			highlight_icon_building = {
				name = "building_icon_can_upgrade"
				visible = "[GUIBuildingItem.CanUpgrade]"
				parentanchor = center
				size = { 40 40 }
				texture = "[GUIBuildingItem.GetCurrentOrConstrucingBuilding.GetTypeIcon]"
			}

			text_single= {
				visible = "[GUIBuildingItem.HasLevel]"
				text = "[GUIBuildingItem.GetCurrentOrConstrucingBuilding.GetLevel]"
				parentanchor = bottom|right
				position = { -6 -3 }
				fontsize = 15
				default_format = "#low;bold"
				align = nobaseline

				background = {
					using = Background_Area_Dark
					margin = { 5 0 }
				}

				background = {
					using = Background_Area_Dark
					margin = { 5 0 }
				}

				background = {
					using = Background_Area_Dark
					margin = { 5 0 }
				}
			}

			warning_icon = {
				name = "reduced_by_fixable_situation"
				visible = "[GUIBuildingItem.IsBuildingDisabled]"
				size = { 25 25 }
			}
		}

		icon = {
			name = "building_slot"
			size = { 100% 100% }
			using = Background_Area
			visible = "[GUIBuildingItem.IsBuildingSlotShown]"
		}

		progressbar_standard = {
			name = "construct_progressbar"
			visible = "[GUIBuildingItem.IsConstructing]"
			parentanchor = bottom
			position = { 0 8 }
			alwaystransparent = yes
			size = { 100% 10 }
			value = "[GUIBuildingItem.GetConstructingProgress]"
			direction = horizontal
			tooltip = "[GUIBuildingItem.GetTooltip]"
		}
	}

	type building_in_vassal_warning_hbox = hbox
	{
		name = "vassal_warning"
		visible = "[Not( ObjectsEqual( HoldingView.GetHolder, GetPlayer ) )]"

		coa_title_tiny = {
			datacontext = "[HoldingView.GetHolder.GetPrimaryTitle]"
		}

		text_multi = {
			autoresize = yes
			text = "HOLDING_VIEW_BUILDING_IN_VASSAL"
		}
	}

	# Requires County and CountyDataBreakdowns data context
	type county_control_tooltip_container = container
	{
		using = GeneralTooltipSetup
		alwaystransparent = no

		object_tooltip_pop_out = {
			blockoverride "title_text"
			{
				margin = { 0 8 }
				text = "COUNTY_CONTROL_TOOLTIP_HEADER"
				default_format = "#T"
			}

			blockoverride "concept_link"
			{
				visible = no
			}

			blockoverride "main_description"
			{
				vbox = {
					layoutpolicy_horizontal = expanding

					cooltip_paragraph = {
						text = "[County.GetCountyControlEffectsDesc]"
					}

					spacer = {
						size = { 0 15 }
					}

					cooltip_paragraph = {
						datacontext = "[CountyDataBreakdowns.AccessControl( County.Self )]"

						text = "VALUE_BRREAKDOWN_TEXT_LINK"

						tooltip_visible = "[ValueBreakdown.HasTooltip]"

						tooltipwidget = {
							widget_value_breakdown_tooltip = {}
						}
					}
				}
			}
		}
	}

	# Requires County and CountyDataBreakdowns data context
	type county_development_tooltip_container = container
	{
		using = GeneralTooltipSetup
		alwaystransparent = no

		object_tooltip_pop_out = {
			blockoverride "title_text"
			{
				margin = { 0 8 }
				text = "COUNTY_DEVELOPMENT_TOOLTIP_HEADER"
				default_format = "#T"
			}

			blockoverride "concept_link"
			{
				visible = no
			}

			blockoverride "main_description"
			{
				vbox = {
					layoutpolicy_horizontal = expanding

					datacontext = "[County.GetCount]"
					datacontext = "[Character.GetGovernment]"

					cooltip_paragraph = {
						visible = "[Not( GovernmentType.IsAffectedByDevelopment )]"
						text = "COUNTY_DEVELOPMENT_IGNORED_DESC"
					}

					cooltip_paragraph = {
						text = "[County.GetCountyDevelopmentEffectsDesc]"
					}

					spacer = {
						size = { 0 15 }
					}

					cooltip_paragraph = {
						text = "[County.GetDevelopmentProgressOutOfMax]"
					}

					cooltip_paragraph = {
						datacontext = "[CountyDataBreakdowns.AccessDevelopmentChange( County.Self )]"

						text = "VALUE_BRREAKDOWN_TEXT_LINK"

						tooltip_visible = "[ValueBreakdown.HasTooltip]"

						tooltipwidget = {
							widget_value_breakdown_tooltip = {}
						}
					}
				}
			}
		}
	}

	
	type widget_county_amenity_left = widget
	{
		size = { 368 98 }

		background = {
			using = Background_Area_With_Header

			modify_texture = {
				texture = "gfx/interface/window_roco_grandeur/mask_court_amenity_right.dds"
				blend_mode = alphamultiply
			}
		}

		widget = {
			name = "radio_button_bar"
			size = { 320 98 }

			icon = {
				name = "radio_button_bg"
				texture = "gfx/interface/window_roco_grandeur/amenity_level_bg.dds"
				size = { 256 54 }
				position = { 56 27 }
			}

			flowcontainer = {
				parentanchor = right
				margin_top = 6
								
				text_single = {
					block "amenity_name" { text = "[demd_public_order|E]" }
					default_format = "#high"
					align = nobaseline
					margin = { 5 0 }
				}				

				spacer = {
					size = { 4 0 }
				}


			}

			text_single = {
				name = "current_level"
				# Account for levels being zero indexed
				block "amenity_level_int" { text = "[Province.GetCounty.GetTitle.MakeScope.Var('public_order_amenities_level').GetValue|0]" }
				align = center
				widgetanchor = center
				position = { 84 51 }
				using = Font_Size_Medium
			}

			widget = {
				name = "progressbar_widget"
				size = { 200 10 }
				position = { 120 50 }

				progressbar_standard = {
					name = "progressbar_court_amenities"
					layoutpolicy_horizontal = expanding
					size = { 150 10 }
					min = 0
					max = 100
					value = 0
				}
			}


			flowcontainer = {
				datamodel = "[CourtAmenitiesCategoryItem.AccessPossibleSettings]"
				spacing = 8
				margin_left = 110
				margin_top = 39

				
				button_radio = { # None
					size = { 30 30}
					
					block "amenity_level_0_effects" { 
						onclick = "[GetScriptedGui('demd_set_public_order_0').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
						enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_public_order_0').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]" 						
					}
					frame = 1
					icon = {
						framesize = { 120 120 }
						frame = 1
						size = { 70 70 }
						position = { 1 1 }
						parentanchor = center
						block "amenity_level_0_visible_sunburst" { 
						visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_amenities_level').GetValue, '(CFixedPoint)0')]"
						}
						texture = "gfx/interface/window_roco_grandeur/radio_button_decoration.dds"
					}

					button_radio = {
						block "amenity_level_0_visible_dot" {
						visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_amenities_level').GetValue, '(CFixedPoint)0')]"
						}
						frame = 2
						alwaystransparent = yes
					}

					block "amenity_level_0_tooltip" { }
				}

				button_radio = { # Low
					size = { 30 30}
					
					block "amenity_level_1_effects" { 
						onclick = "[GetScriptedGui('demd_set_public_order_1').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
						enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_public_order_1').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]" 						
					}
					frame = 1
					icon = {
						framesize = { 120 120 }
						frame = 1
						size = { 70 70 }
						position = { 1 1 }
						parentanchor = center
						block "amenity_level_1_visible_sunburst" { 
						visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_amenities_level').GetValue, '(CFixedPoint)1')]"
						}
						texture = "gfx/interface/window_roco_grandeur/radio_button_decoration.dds"
					}

					button_radio = {
						block "amenity_level_1_visible_dot" {
						visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_amenities_level').GetValue, '(CFixedPoint)1')]"
						}
						frame = 2
						alwaystransparent = yes
					}

					block "amenity_level_1_tooltip" { }
				}	

				button_radio = { # Moderate
					size = { 30 30}
					
					block "amenity_level_2_effects" { 
						onclick = "[GetScriptedGui('demd_set_public_order_2').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
						enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_public_order_2').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]" 						
					}
					frame = 1
					icon = {
						framesize = { 120 120 }
						frame = 1
						size = { 70 70 }
						position = { 1 1 }
						parentanchor = center
						block "amenity_level_2_visible_sunburst" { 
						visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_amenities_level').GetValue, '(CFixedPoint)2')]"
						}
						texture = "gfx/interface/window_roco_grandeur/radio_button_decoration.dds"
					}

					button_radio = {
						block "amenity_level_2_visible_dot" {
						visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_amenities_level').GetValue, '(CFixedPoint)2')]"
						}
						frame = 2
						alwaystransparent = yes
					}

					block "amenity_level_2_tooltip" { }
				}

				button_radio = { # High
					size = { 30 30}
					
					block "amenity_level_3_effects" { 
						onclick = "[GetScriptedGui('demd_set_public_order_3').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
						enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_public_order_3').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]" 						
					}
					frame = 1
					icon = {
						framesize = { 120 120 }
						frame = 1
						size = { 70 70 }
						position = { 1 1 }
						parentanchor = center
						block "amenity_level_3_visible_sunburst" { 
						visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_amenities_level').GetValue, '(CFixedPoint)3')]"
						}
						texture = "gfx/interface/window_roco_grandeur/radio_button_decoration.dds"
					}

					button_radio = {
						block "amenity_level_3_visible_dot" {
						visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_amenities_level').GetValue, '(CFixedPoint)3')]"
						}
						frame = 2
						alwaystransparent = yes
					}

					block "amenity_level_3_tooltip" { }
				}	

				button_radio = { # Extravagant
					size = { 30 30 }
					
					block "amenity_level_4_effects" { 
						onclick = "[GetScriptedGui('demd_set_public_order_4').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
						enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_public_order_4').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]" 						
					}
					frame = 1
					icon = {
						framesize = { 120 120 }
						frame = 1
						size = { 70 70 }
						position = { 1 1 }
						parentanchor = center
						block "amenity_level_4_visible_sunburst" { 
						visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_amenities_level').GetValue, '(CFixedPoint)4')]"
						}
						texture = "gfx/interface/window_roco_grandeur/radio_button_decoration.dds"
					}

					button_radio = {
						block "amenity_level_4_visible_dot" {
						visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_amenities_level').GetValue, '(CFixedPoint)4')]"
						}
						frame = 2
						alwaystransparent = yes
					}

					block "amenity_level_4_tooltip" { }
				}				
			}
		}

		icon = {
			name = "banner_icon"
			framesize = { 160 160 }
			frame = 1
			size = { 94 94 }
			position = { 292 0 }

			block "amenity_icon_texture"
			{
				texture = "gfx/interface/window_roco_grandeur/icon_amenity_fashion.dds"
			}
		}
	}	
	
	type widget_county_amenity_right = widget
	{
		size = { 368 98 }

		background = {
			using = Background_Area_With_Header

			modify_texture = {
				texture = "gfx/interface/window_roco_grandeur/mask_court_amenity_left.dds"
				blend_mode = alphamultiply
			}
		}

		widget = {
			name = "radio_button_bar"
			size = { 320 98 }

			icon = {
				name = "radio_button_bg"
				texture = "gfx/interface/window_roco_grandeur/amenity_level_bg.dds"
				size = { 256 54 }
				position = { 56 27 }
			}

			flowcontainer = {
				margin_left = 58
				margin_top = 6

				text_single = {
					block "amenity_name" { text = "[demd_public_order|E]" }
					default_format = "#high"
					align = left
					margin_right = 5
					margin_top = -2
				}

			}

			text_single = {
				name = "current_level"
				# Account for levels being zero indexed
				block "amenity_level_int" { text = "[Province.GetCounty.GetTitle.MakeScope.Var('public_order_amenities_level').GetValue|0]" }
				align = center
				widgetanchor = center
				position = { 84 51 }
				using = Font_Size_Medium
			}

			widget = {
				name = "progressbar_widget"
				size = { 200 10 }
				position = { 120 50 }

				progressbar_standard = {
					name = "progressbar_court_amenities"
					layoutpolicy_horizontal = expanding
					size = { 150 10 }
					min = 0
					max = 100
					value = 0
				}
			}


			flowcontainer = {
				datamodel = "[CourtAmenitiesCategoryItem.AccessPossibleSettings]"
				spacing = 8
				margin_left = 110
				margin_top = 39

				
				button_radio = { # None
					size = { 30 30}
					
					block "amenity_level_0_effects" { 
						onclick = "[GetScriptedGui('demd_set_public_order_0').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
						enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_public_order_0').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]" 						
					}
					frame = 1
					icon = {
						framesize = { 120 120 }
						frame = 1
						size = { 70 70 }
						position = { 1 1 }
						parentanchor = center
						block "amenity_level_0_visible_sunburst" { 
						visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_amenities_level').GetValue, '(CFixedPoint)0')]"
						}
						texture = "gfx/interface/window_roco_grandeur/radio_button_decoration.dds"
					}

					button_radio = {
						block "amenity_level_0_visible_dot" {
						visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_amenities_level').GetValue, '(CFixedPoint)0')]"
						}
						frame = 2
						alwaystransparent = yes
					}

					block "amenity_level_0_tooltip" { }
				}

				button_radio = { # Low
					size = { 30 30}
					
					block "amenity_level_1_effects" { 
						onclick = "[GetScriptedGui('demd_set_public_order_1').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
						enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_public_order_1').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]" 						
					}
					frame = 1
					icon = {
						framesize = { 120 120 }
						frame = 1
						size = { 70 70 }
						position = { 1 1 }
						parentanchor = center
						block "amenity_level_1_visible_sunburst" { 
						visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_amenities_level').GetValue, '(CFixedPoint)1')]"
						}
						texture = "gfx/interface/window_roco_grandeur/radio_button_decoration.dds"
					}

					button_radio = {
						block "amenity_level_1_visible_dot" {
						visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_amenities_level').GetValue, '(CFixedPoint)1')]"
						}
						frame = 2
						alwaystransparent = yes
					}

					block "amenity_level_1_tooltip" { }
				}	

				button_radio = { # Moderate
					size = { 30 30}
					
					block "amenity_level_2_effects" { 
						onclick = "[GetScriptedGui('demd_set_public_order_2').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
						enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_public_order_2').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]" 						
					}
					frame = 1
					icon = {
						framesize = { 120 120 }
						frame = 1
						size = { 70 70 }
						position = { 1 1 }
						parentanchor = center
						block "amenity_level_2_visible_sunburst" { 
						visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_amenities_level').GetValue, '(CFixedPoint)2')]"
						}
						texture = "gfx/interface/window_roco_grandeur/radio_button_decoration.dds"
					}

					button_radio = {
						block "amenity_level_2_visible_dot" {
						visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_amenities_level').GetValue, '(CFixedPoint)2')]"
						}
						frame = 2
						alwaystransparent = yes
					}

					block "amenity_level_2_tooltip" { }
				}

				button_radio = { # High
					size = { 30 30}
					
					block "amenity_level_3_effects" { 
						onclick = "[GetScriptedGui('demd_set_public_order_3').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
						enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_public_order_3').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]" 						
					}
					frame = 1
					icon = {
						framesize = { 120 120 }
						frame = 1
						size = { 70 70 }
						position = { 1 1 }
						parentanchor = center
						block "amenity_level_3_visible_sunburst" { 
						visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_amenities_level').GetValue, '(CFixedPoint)3')]"
						}
						texture = "gfx/interface/window_roco_grandeur/radio_button_decoration.dds"
					}

					button_radio = {
						block "amenity_level_3_visible_dot" {
						visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_amenities_level').GetValue, '(CFixedPoint)3')]"
						}
						frame = 2
						alwaystransparent = yes
					}

					block "amenity_level_3_tooltip" { }
				}	

				button_radio = { # Extravagant
					size = { 30 30 }
					
					block "amenity_level_4_effects" { 
						onclick = "[GetScriptedGui('demd_set_public_order_4').Execute( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End ) ]"
						enabled = "[And(EqualTo_uint32( HoldingView.GetCountyTitle.GetHolder.GetID,GetPlayer.GetID),GetScriptedGui('demd_set_public_order_4').IsValid( GuiScope.SetRoot( Province.GetCounty.GetTitle.MakeScope ).End))]" 						
					}
					frame = 1
					icon = {
						framesize = { 120 120 }
						frame = 1
						size = { 70 70 }
						position = { 1 1 }
						parentanchor = center
						block "amenity_level_4_visible_sunburst" { 
						visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_amenities_level').GetValue, '(CFixedPoint)4')]"
						}
						texture = "gfx/interface/window_roco_grandeur/radio_button_decoration.dds"
					}

					button_radio = {
						block "amenity_level_4_visible_dot" {
						visible = "[EqualTo_CFixedPoint( Province.GetCounty.GetTitle.MakeScope.Var('public_order_amenities_level').GetValue, '(CFixedPoint)4')]"
						}
						frame = 2
						alwaystransparent = yes
					}

					block "amenity_level_4_tooltip" { }
				}				
			}
		}

		icon = {
			name = "banner_icon"
			framesize = { 160 160 }
			size = { 94 94 }
			position = { -18 0 }

			block "amenity_icon_texture"
			{
				texture = "gfx/interface/window_roco_grandeur/icon_amenity_fashion.dds"
			}
		}
	}
	
	type widget_amenity_level_divider = widget 
	{
		widget = {
			name = "level_divider"
			size = { 0 30 }
			allow_outside = yes

			icon = {
				#visible = "[CourtGrandeurLevel.ShouldShow]"
				size = { 3 36 }
				block "position" { position = { @progress_bar_spacer_1 14 } }
				widgetanchor = center
				texture = "gfx/interface/colors/white.dds"
				color = { 1 1 1 1 }
				alpha = 0.2
				spriteType = Corneredtiled

				## EDGE FADE
				modify_texture = {
					texture = "gfx/interface/component_masks/mask_edge_3px.dds"
					spriteType = Corneredtiled
					spriteborder = { 4 4 }
					blend_mode = alphamultiply
				}

				### SCRATCHES
				modify_texture = {
					texture = "gfx/interface/component_masks/mask_scratches.dds"
					spriteType = Corneredtiled
					spriteborder = { 0 0 }
					blend_mode = alphamultiply
				}
			}
		}
	}	

	type widget_amenity_level_marker = widget 
	{
		widget = {
			flowcontainer = {
				name = "level_items"
				parentanchor = top|hcenter
				block "position" { position = { @progress_bar_spacer_1 -28 } }
				

				allow_outside = yes
				ignoreinvisible = no

				widget = {
					name = "level_item"
					size = { 0 20 }
					allow_outside = yes
					
					### Expected grandeur level ###
					widget = {
						size = { 60 80 }
						position = { 0 10 }
						widgetanchor = center
						

						icon = {
							name = "highlight_current_level"
							size = { 80 80 }
							position = { 0 -10 }
							parentanchor = center
							texture = "gfx/interface/window_roco_grandeur/pin_highlight.dds"
							block "current_level_equals_this" { visible = "[EqualTo_CFixedPoint( '(CFixedPoint)1', Province.GetCounty.GetTitle.MakeScope.Var('current_amenities_level').GetValue )]" }

							state = {
								name = _show
								using = Animation_Curve_Default
								duration = 0.3
								alpha = 0.7
							}

							state = {
								name = _hide
								using = Animation_Curve_Default
								duration = 0.6
								alpha = 0
							}

							state = {
								name = "a"
								next = "b"
								trigger_on_create = yes
								alpha = 0.7

								modify_texture = {
									name = "glow_1"
									rotate_uv = 0
								}

								modify_texture = {
									name = "glow_2"
									rotate_uv = 0
								}
							}

							state = {
								name = "b"
								next = "a"
								duration = 7

								modify_texture = {
									name = "glow_1"
									rotate_uv = 360
								}

								modify_texture = {
									name = "glow_2"
									rotate_uv = -360
								}
							}

							modify_texture = {
								name = "glow_1"
								texture = "gfx/interface/component_masks/mask_glow.dds"
								blend_mode = alphamultiply
							}

							modify_texture = {
								name = "glow_2"
								texture = "gfx/interface/component_masks/mask_glow.dds"
								blend_mode = alphamultiply
							}
						}

						widget = {
							name = "expected_grandeur_level"
							size = { 30 48 }
							allow_outside = yes
							parentanchor = bottom|hcenter

							### Expected grandeur pin
							icon = {
								framesize = { 96 96 }
								size = { 48 48 }
								parentanchor = bottom|hcenter
								position = { 0 5 }
								block "current_level_equals_this" { visible = "[EqualTo_CFixedPoint( '(CFixedPoint)1', Province.GetCounty.GetTitle.MakeScope.Var('current_amenities_level').GetValue )]" }
								
								texture = "gfx/interface/window_roco_grandeur/pin_expected_grandeur_bg.dds"
							}

							icon = {
								framesize = { 70 70 }
								size = { 35 35 }
								parentanchor = bottom|hcenter
								position = { 0 0 }
								block "current_level_equals_this" { visible = "[EqualTo_CFixedPoint( '(CFixedPoint)1', Province.GetCounty.GetTitle.MakeScope.Var('current_amenities_level').GetValue )]" }
							}

							
						}
					}

					widget = {
						name = "level_backgrounds"
						size = { 60 60 }
						widgetanchor = center

						### Level background level 1
						icon_grandeur_level = {
							texture = "gfx/interface/window_roco_grandeur/pin_grandeur_rank_01.dds"
						}

					}

					### LEVEL ###
					text_single = {
						block "current_level" { raw_text = "1" }
						align = center
						widgetanchor = center
						parentanchor = center
						position = { 0 -13 }
					}
					
					block "tooltip" { raw_text = DEMD_AMENITY_LEVEL_1_TOOLTIP # really a TT but need to suppress the error }
				}
				
			}
		}
	}		
}

